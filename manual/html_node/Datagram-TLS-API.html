<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- This manual is last updated 4 March 2015 for version
3.5.3 of GnuTLS.

Copyright (C) 2001-2015 Free Software Foundation, Inc.\\
Copyright (C) 2001-2015 Nikos Mavrogiannopoulos

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.3 or
any later version published by the Free Software Foundation; with no
Invariant Sections, no Front-Cover Texts, and no Back-Cover Texts.  A
copy of the license is included in the section entitled "GNU Free
Documentation License". -->
<!-- Created by GNU Texinfo 6.1, http://www.gnu.org/software/texinfo/ -->
<head>
<title>GnuTLS 3.5.3: Datagram TLS API</title>

<meta name="description" content="GnuTLS 3.5.3: Datagram TLS API">
<meta name="keywords" content="GnuTLS 3.5.3: Datagram TLS API">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link href="index.html#Top" rel="start" title="Top">
<link href="Function-and-Data-Index.html#Function-and-Data-Index" rel="index" title="Function and Data Index">
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="API-reference.html#API-reference" rel="up" title="API reference">
<link href="X509-certificate-API.html#X509-certificate-API" rel="next" title="X509 certificate API">
<link href="Core-TLS-API.html#Core-TLS-API" rel="prev" title="Core TLS API">
<style type="text/css">
<!--
a.summary-letter {text-decoration: none}
blockquote.indentedblock {margin-right: 0em}
blockquote.smallindentedblock {margin-right: 0em; font-size: smaller}
blockquote.smallquotation {font-size: smaller}
div.display {margin-left: 3.2em}
div.example {margin-left: 3.2em}
div.lisp {margin-left: 3.2em}
div.smalldisplay {margin-left: 3.2em}
div.smallexample {margin-left: 3.2em}
div.smalllisp {margin-left: 3.2em}
kbd {font-style: oblique}
pre.display {font-family: inherit}
pre.format {font-family: inherit}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
pre.smalldisplay {font-family: inherit; font-size: smaller}
pre.smallexample {font-size: smaller}
pre.smallformat {font-family: inherit; font-size: smaller}
pre.smalllisp {font-size: smaller}
span.nolinebreak {white-space: nowrap}
span.roman {font-family: initial; font-weight: normal}
span.sansserif {font-family: sans-serif; font-weight: normal}
ul.no-bullet {list-style: none}
body { 
	margin: 2%;
	padding: 0 5%;
	background: #ffffff;
}
h1,h2,h3,h4,h5 {
    font-weight: bold;
    padding: 5px 5px 5px 5px;
    background-color: #c2e0ff;
    color: #336699;
}
h1 {
    padding: 2em 2em 2em 5%;
    color: white;
    background: #336699;
    text-align: center;
    letter-spacing: 3px;
}
h2 { text-decoration: underline; }
pre {
  margin: 0 5%;
  padding: 0.5em;
}
pre.example,pre.verbatim {
  padding-bottom: 1em;

  border: solid #c2e0ff;
  background: #f0faff;
  border-width: 1px 1px 1px 5px;
  margin: 1em auto;
  width: 90%;
}

div.node {
  margin: 0 -5% 0 -2%;
  padding: 0.5em 0.5em;
  margin-top: 0.5em;
  margin-bottom: 0.5em;
  font-weight: bold;
}
dd, li {
  padding-top: 0.1em;
  padding-bottom: 0.1em;
}
div.float {

  margin-bottom: 0.5em;
  text-align: center;
}

table {
  text-align: left;
  margin-left:auto;
  margin-right:auto;
  border-spacing: 7px;
  width: 50%;
}

th {
  padding: 0;
  color: #336699;
  background-color: #c2e0ff;
  border: solid #000000;
  border-width: 0px;
  margin: 1em auto;
  text-align: center;
  margin-left:auto;
  margin-right:auto;
}

td {
  padding: 0;
  border: solid #000000;
  background-color: #f0faff;
  border-width: 0px;
  margin: 1em auto;
  text-align: left;
  margin-left:auto;
  margin-right:auto;
  padding-left: 1em;
}

dl {
  text-align: left;
  margin-left:auto;
  margin-right:auto;
  width: 50%;

  padding-left: 1em;
  border: solid #c2e0ff;
  background: #f0faff;
  border-width: 5px 1px 1px 1px;
  margin: 1em auto;
}

-->
</style>


</head>

<body lang="en">
<a name="Datagram-TLS-API"></a>
<div class="header">
<p>
Next: <a href="X509-certificate-API.html#X509-certificate-API" accesskey="n" rel="next">X509 certificate API</a>, Previous: <a href="Core-TLS-API.html#Core-TLS-API" accesskey="p" rel="prev">Core TLS API</a>, Up: <a href="API-reference.html#API-reference" accesskey="u" rel="up">API reference</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Function-and-Data-Index.html#Function-and-Data-Index" title="Index" rel="index">Index</a>]</p>
</div>
<hr>
<a name="Datagram-TLS-API-1"></a>
<h3 class="section">E.2 Datagram TLS API</h3>

<p>The prototypes for the following functions lie in
<samp>gnutls/dtls.h</samp>.
</p>

<a name="gnutls_005fdtls_005fcookie_005fsend-1"></a>
<h4 class="subheading">gnutls_dtls_cookie_send</h4>
<a name="gnutls_005fdtls_005fcookie_005fsend"></a><dl>
<dt><a name="index-gnutls_005fdtls_005fcookie_005fsend"></a>Function: <em>int</em> <strong>gnutls_dtls_cookie_send</strong> <em>(gnutls_datum_t * <var>key</var>, void * <var>client_data</var>, size_t <var>client_data_size</var>, gnutls_dtls_prestate_st * <var>prestate</var>, gnutls_transport_ptr_t <var>ptr</var>, gnutls_push_func <var>push_func</var>)</em></dt>
<dd><p><var>key</var>: is a random key to be used at cookie generation
</p>
<p><var>client_data</var>: contains data identifying the client (i.e. address)
</p>
<p><var>client_data_size</var>: The size of client&rsquo;s data
</p>
<p><var>prestate</var>: The previous cookie returned by <code>gnutls_dtls_cookie_verify()</code> 
</p>
<p><var>ptr</var>: A transport pointer to be used by  <code>push_func</code> 
</p>
<p><var>push_func</var>: A function that will be used to reply
</p>
<p>This function can be used to prevent denial of service
attacks to a DTLS server by requiring the client to
reply using a cookie sent by this function. That way
it can be ensured that a client we allocated resources
for (i.e. <code>gnutls_session_t</code> ) is the one that the 
original incoming packet was originated from.
</p>
<p>This function must be called at the first incoming packet,
prior to allocating any resources and must be succeeded
by <code>gnutls_dtls_cookie_verify()</code> .
</p>
<p><strong>Returns:</strong> the number of bytes sent, or a negative error code.  
</p>
<p><strong>Since:</strong> 3.0
</p></dd></dl>

<a name="gnutls_005fdtls_005fcookie_005fverify-1"></a>
<h4 class="subheading">gnutls_dtls_cookie_verify</h4>
<a name="gnutls_005fdtls_005fcookie_005fverify"></a><dl>
<dt><a name="index-gnutls_005fdtls_005fcookie_005fverify"></a>Function: <em>int</em> <strong>gnutls_dtls_cookie_verify</strong> <em>(gnutls_datum_t * <var>key</var>, void * <var>client_data</var>, size_t <var>client_data_size</var>, void * <var>_msg</var>, size_t <var>msg_size</var>, gnutls_dtls_prestate_st * <var>prestate</var>)</em></dt>
<dd><p><var>key</var>: is a random key to be used at cookie generation
</p>
<p><var>client_data</var>: contains data identifying the client (i.e. address)
</p>
<p><var>client_data_size</var>: The size of client&rsquo;s data
</p>
<p><var>_msg</var>: An incoming message that initiates a connection.
</p>
<p><var>msg_size</var>: The size of the message.
</p>
<p><var>prestate</var>: The cookie of this client.
</p>
<p>This function will verify the received message for
a valid cookie. If a valid cookie is returned then
it should be associated with the session using
<code>gnutls_dtls_prestate_set()</code> ;
</p>
<p>This function must be called after <code>gnutls_dtls_cookie_send()</code> .
</p>
<p><strong>Returns:</strong> <code>GNUTLS_E_SUCCESS</code>  (0) on success, or a negative error code.  
</p>
<p><strong>Since:</strong> 3.0
</p></dd></dl>

<a name="gnutls_005fdtls_005fget_005fdata_005fmtu-1"></a>
<h4 class="subheading">gnutls_dtls_get_data_mtu</h4>
<a name="gnutls_005fdtls_005fget_005fdata_005fmtu"></a><dl>
<dt><a name="index-gnutls_005fdtls_005fget_005fdata_005fmtu"></a>Function: <em>unsigned int</em> <strong>gnutls_dtls_get_data_mtu</strong> <em>(gnutls_session_t <var>session</var>)</em></dt>
<dd><p><var>session</var>: is a <code>gnutls_session_t</code>  type.
</p>
<p>This function will return the actual maximum transfer unit for
application data. I.e. DTLS headers are subtracted from the
actual MTU which is set using <code>gnutls_dtls_set_mtu()</code> .
</p>
<p><strong>Returns:</strong> the maximum allowed transfer unit.
</p>
<p><strong>Since:</strong> 3.0
</p></dd></dl>

<a name="gnutls_005fdtls_005fget_005fmtu-1"></a>
<h4 class="subheading">gnutls_dtls_get_mtu</h4>
<a name="gnutls_005fdtls_005fget_005fmtu"></a><dl>
<dt><a name="index-gnutls_005fdtls_005fget_005fmtu"></a>Function: <em>unsigned int</em> <strong>gnutls_dtls_get_mtu</strong> <em>(gnutls_session_t <var>session</var>)</em></dt>
<dd><p><var>session</var>: is a <code>gnutls_session_t</code>  type.
</p>
<p>This function will return the MTU size as set with
<code>gnutls_dtls_set_mtu()</code> . This is not the actual MTU
of data you can transmit. Use <code>gnutls_dtls_get_data_mtu()</code> 
for that reason.
</p>
<p><strong>Returns:</strong> the set maximum transfer unit.
</p>
<p><strong>Since:</strong> 3.0
</p></dd></dl>

<a name="gnutls_005fdtls_005fget_005ftimeout-1"></a>
<h4 class="subheading">gnutls_dtls_get_timeout</h4>
<a name="gnutls_005fdtls_005fget_005ftimeout"></a><dl>
<dt><a name="index-gnutls_005fdtls_005fget_005ftimeout-1"></a>Function: <em>unsigned int</em> <strong>gnutls_dtls_get_timeout</strong> <em>(gnutls_session_t <var>session</var>)</em></dt>
<dd><p><var>session</var>: is a <code>gnutls_session_t</code>  type.
</p>
<p>This function will return the milliseconds remaining
for a retransmission of the previously sent handshake
message. This function is useful when DTLS is used in
non-blocking mode, to estimate when to call <code>gnutls_handshake()</code> 
if no packets have been received.
</p>
<p><strong>Returns:</strong> the remaining time in milliseconds.
</p>
<p><strong>Since:</strong> 3.0
</p></dd></dl>

<a name="gnutls_005fdtls_005fprestate_005fset-1"></a>
<h4 class="subheading">gnutls_dtls_prestate_set</h4>
<a name="gnutls_005fdtls_005fprestate_005fset"></a><dl>
<dt><a name="index-gnutls_005fdtls_005fprestate_005fset"></a>Function: <em>void</em> <strong>gnutls_dtls_prestate_set</strong> <em>(gnutls_session_t <var>session</var>, gnutls_dtls_prestate_st * <var>prestate</var>)</em></dt>
<dd><p><var>session</var>: a new session
</p>
<p><var>prestate</var>: contains the client&rsquo;s prestate
</p>
<p>This function will associate the prestate acquired by
the cookie authentication with the client, with the newly 
established session.
</p>
<p>This functions must be called after a successful <code>gnutls_dtls_cookie_verify()</code> 
and should be succeeded by the actual DTLS handshake using <code>gnutls_handshake()</code> .
</p>
<p><strong>Since:</strong> 3.0
</p></dd></dl>

<a name="gnutls_005fdtls_005fset_005fdata_005fmtu-1"></a>
<h4 class="subheading">gnutls_dtls_set_data_mtu</h4>
<a name="gnutls_005fdtls_005fset_005fdata_005fmtu"></a><dl>
<dt><a name="index-gnutls_005fdtls_005fset_005fdata_005fmtu"></a>Function: <em>int</em> <strong>gnutls_dtls_set_data_mtu</strong> <em>(gnutls_session_t <var>session</var>, unsigned int <var>mtu</var>)</em></dt>
<dd><p><var>session</var>: is a <code>gnutls_session_t</code>  type.
</p>
<p><var>mtu</var>: The maximum unencrypted transfer unit of the session
</p>
<p>This function will set the maximum size of the *unencrypted* records
which will be sent over a DTLS session. It is equivalent to calculating
the DTLS packet overhead with the current encryption parameters, and
calling <code>gnutls_dtls_set_mtu()</code>  with that value. In particular, this means
that you may need to call this function again after any negotiation or
renegotiation, in order to ensure that the MTU is still sufficient to
account for the new protocol overhead.
</p>
<p>In most cases you only need to call <code>gnutls_dtls_set_mtu()</code>  with
the maximum MTU of your transport layer.
</p>
<p><strong>Returns:</strong> <code>GNUTLS_E_SUCCESS</code>  (0) on success, or a negative error code.
</p>
<p><strong>Since:</strong> 3.1
</p></dd></dl>

<a name="gnutls_005fdtls_005fset_005fmtu-1"></a>
<h4 class="subheading">gnutls_dtls_set_mtu</h4>
<a name="gnutls_005fdtls_005fset_005fmtu"></a><dl>
<dt><a name="index-gnutls_005fdtls_005fset_005fmtu"></a>Function: <em>void</em> <strong>gnutls_dtls_set_mtu</strong> <em>(gnutls_session_t <var>session</var>, unsigned int <var>mtu</var>)</em></dt>
<dd><p><var>session</var>: is a <code>gnutls_session_t</code>  type.
</p>
<p><var>mtu</var>: The maximum transfer unit of the transport
</p>
<p>This function will set the maximum transfer unit of the transport
that DTLS packets are sent over. Note that this should exclude
the IP (or IPv6) and UDP headers. So for DTLS over IPv6 on an
Ethernet device with MTU 1500, the DTLS MTU set with this function
would be 1500 - 40 (IPV6 header) - 8 (UDP header) = 1452.
</p>
<p><strong>Since:</strong> 3.0
</p></dd></dl>

<a name="gnutls_005fdtls_005fset_005ftimeouts-1"></a>
<h4 class="subheading">gnutls_dtls_set_timeouts</h4>
<a name="gnutls_005fdtls_005fset_005ftimeouts"></a><dl>
<dt><a name="index-gnutls_005fdtls_005fset_005ftimeouts"></a>Function: <em>void</em> <strong>gnutls_dtls_set_timeouts</strong> <em>(gnutls_session_t <var>session</var>, unsigned int <var>retrans_timeout</var>, unsigned int <var>total_timeout</var>)</em></dt>
<dd><p><var>session</var>: is a <code>gnutls_session_t</code>  type.
</p>
<p><var>retrans_timeout</var>: The time at which a retransmission will occur in milliseconds
</p>
<p><var>total_timeout</var>: The time at which the connection will be aborted, in milliseconds.
</p>
<p>This function will set the timeouts required for the DTLS handshake
protocol. The retransmission timeout is the time after which a
message from the peer is not received, the previous messages will
be retransmitted. The total timeout is the time after which the
handshake will be aborted with <code>GNUTLS_E_TIMEDOUT</code> .
</p>
<p>The DTLS protocol recommends the values of 1 sec and 60 seconds
respectively, and these are the default values.
</p>
<p>To disable retransmissions set a  <code>retrans_timeout</code> larger than the  <code>total_timeout</code> .
</p>
<p><strong>Since:</strong> 3.0
</p></dd></dl>

<a name="gnutls_005frecord_005fget_005fdiscarded-1"></a>
<h4 class="subheading">gnutls_record_get_discarded</h4>
<a name="gnutls_005frecord_005fget_005fdiscarded"></a><dl>
<dt><a name="index-gnutls_005frecord_005fget_005fdiscarded"></a>Function: <em>unsigned int</em> <strong>gnutls_record_get_discarded</strong> <em>(gnutls_session_t <var>session</var>)</em></dt>
<dd><p><var>session</var>: is a <code>gnutls_session_t</code>  type.
</p>
<p>Returns the number of discarded packets in a
DTLS connection.
</p>
<p><strong>Returns:</strong> The number of discarded packets.
</p>
<p><strong>Since:</strong> 3.0
</p></dd></dl>


<hr>
<div class="header">
<p>
Next: <a href="X509-certificate-API.html#X509-certificate-API" accesskey="n" rel="next">X509 certificate API</a>, Previous: <a href="Core-TLS-API.html#Core-TLS-API" accesskey="p" rel="prev">Core TLS API</a>, Up: <a href="API-reference.html#API-reference" accesskey="u" rel="up">API reference</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Function-and-Data-Index.html#Function-and-Data-Index" title="Index" rel="index">Index</a>]</p>
</div>



</body>
</html>
