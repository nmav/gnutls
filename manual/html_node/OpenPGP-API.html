<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- This manual is last updated 4 March 2015 for version
3.5.2 of GnuTLS.

Copyright (C) 2001-2015 Free Software Foundation, Inc.\\
Copyright (C) 2001-2015 Nikos Mavrogiannopoulos

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.3 or
any later version published by the Free Software Foundation; with no
Invariant Sections, no Front-Cover Texts, and no Back-Cover Texts.  A
copy of the license is included in the section entitled "GNU Free
Documentation License". -->
<!-- Created by GNU Texinfo 6.1, http://www.gnu.org/software/texinfo/ -->
<head>
<title>GnuTLS 3.5.2: OpenPGP API</title>

<meta name="description" content="GnuTLS 3.5.2: OpenPGP API">
<meta name="keywords" content="GnuTLS 3.5.2: OpenPGP API">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link href="index.html#Top" rel="start" title="Top">
<link href="Function-and-Data-Index.html#Function-and-Data-Index" rel="index" title="Function and Data Index">
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="API-reference.html#API-reference" rel="up" title="API reference">
<link href="PKCS-12-API.html#PKCS-12-API" rel="next" title="PKCS 12 API">
<link href="OCSP-API.html#OCSP-API" rel="prev" title="OCSP API">
<style type="text/css">
<!--
a.summary-letter {text-decoration: none}
blockquote.indentedblock {margin-right: 0em}
blockquote.smallindentedblock {margin-right: 0em; font-size: smaller}
blockquote.smallquotation {font-size: smaller}
div.display {margin-left: 3.2em}
div.example {margin-left: 3.2em}
div.lisp {margin-left: 3.2em}
div.smalldisplay {margin-left: 3.2em}
div.smallexample {margin-left: 3.2em}
div.smalllisp {margin-left: 3.2em}
kbd {font-style: oblique}
pre.display {font-family: inherit}
pre.format {font-family: inherit}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
pre.smalldisplay {font-family: inherit; font-size: smaller}
pre.smallexample {font-size: smaller}
pre.smallformat {font-family: inherit; font-size: smaller}
pre.smalllisp {font-size: smaller}
span.nolinebreak {white-space: nowrap}
span.roman {font-family: initial; font-weight: normal}
span.sansserif {font-family: sans-serif; font-weight: normal}
ul.no-bullet {list-style: none}
body { 
	margin: 2%;
	padding: 0 5%;
	background: #ffffff;
}
h1,h2,h3,h4,h5 {
    font-weight: bold;
    padding: 5px 5px 5px 5px;
    background-color: #c2e0ff;
    color: #336699;
}
h1 {
    padding: 2em 2em 2em 5%;
    color: white;
    background: #336699;
    text-align: center;
    letter-spacing: 3px;
}
h2 { text-decoration: underline; }
pre {
  margin: 0 5%;
  padding: 0.5em;
}
pre.example,pre.verbatim {
  padding-bottom: 1em;

  border: solid #c2e0ff;
  background: #f0faff;
  border-width: 1px 1px 1px 5px;
  margin: 1em auto;
  width: 90%;
}

div.node {
  margin: 0 -5% 0 -2%;
  padding: 0.5em 0.5em;
  margin-top: 0.5em;
  margin-bottom: 0.5em;
  font-weight: bold;
}
dd, li {
  padding-top: 0.1em;
  padding-bottom: 0.1em;
}
div.float {

  margin-bottom: 0.5em;
  text-align: center;
}

table {
  text-align: left;
  margin-left:auto;
  margin-right:auto;
  border-spacing: 7px;
  width: 50%;
}

th {
  padding: 0;
  color: #336699;
  background-color: #c2e0ff;
  border: solid #000000;
  border-width: 0px;
  margin: 1em auto;
  text-align: center;
  margin-left:auto;
  margin-right:auto;
}

td {
  padding: 0;
  border: solid #000000;
  background-color: #f0faff;
  border-width: 0px;
  margin: 1em auto;
  text-align: left;
  margin-left:auto;
  margin-right:auto;
  padding-left: 1em;
}

dl {
  text-align: left;
  margin-left:auto;
  margin-right:auto;
  width: 50%;

  padding-left: 1em;
  border: solid #c2e0ff;
  background: #f0faff;
  border-width: 5px 1px 1px 1px;
  margin: 1em auto;
}

-->
</style>


</head>

<body lang="en">
<a name="OpenPGP-API"></a>
<div class="header">
<p>
Next: <a href="PKCS-12-API.html#PKCS-12-API" accesskey="n" rel="next">PKCS 12 API</a>, Previous: <a href="OCSP-API.html#OCSP-API" accesskey="p" rel="prev">OCSP API</a>, Up: <a href="API-reference.html#API-reference" accesskey="u" rel="up">API reference</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Function-and-Data-Index.html#Function-and-Data-Index" title="Index" rel="index">Index</a>]</p>
</div>
<hr>
<a name="OpenPGP-API-1"></a>
<h3 class="section">E.6 <acronym>OpenPGP</acronym> API</h3>
<a name="index-OpenPGP-API"></a>

<p>The following functions are to be used for <acronym>OpenPGP</acronym>
certificate handling.  Their prototypes lie in
<samp>gnutls/openpgp.h</samp>.
</p>

<a name="gnutls_005fcertificate_005fget_005fopenpgp_005fcrt-1"></a>
<h4 class="subheading">gnutls_certificate_get_openpgp_crt</h4>
<a name="gnutls_005fcertificate_005fget_005fopenpgp_005fcrt"></a><dl>
<dt><a name="index-gnutls_005fcertificate_005fget_005fopenpgp_005fcrt"></a>Function: <em>int</em> <strong>gnutls_certificate_get_openpgp_crt</strong> <em>(gnutls_certificate_credentials_t <var>res</var>, unsigned <var>index</var>, gnutls_openpgp_crt_t ** <var>crt_list</var>, unsigned * <var>crt_list_size</var>)</em></dt>
<dd><p><var>res</var>: is a <code>gnutls_certificate_credentials_t</code>  type.
</p>
<p><var>index</var>: The index of the certificate list to obtain.
</p>
<p><var>crt_list</var>: Where to store the certificate list.
</p>
<p><var>crt_list_size</var>: &ndash; undescribed &ndash;
</p>
<p>Obtains a X.509 certificate list that has been stored in  <code>res</code> with one of
<code>gnutls_certificate_set_openpgp_key()</code> ,
<code>gnutls_certificate_set_openpgp_key_file()</code> ,
<code>gnutls_certificate_set_openpgp_key_file2()</code> ,
<code>gnutls_certificate_set_openpgp_key_mem()</code> , or
<code>gnutls_certificate_set_openpgp_key_mem2()</code> .  Each certificate in the
returned certificate list must be deallocated with
<code>gnutls_openpgp_crt_deinit()</code> , and the list itself must be freed with
<code>gnutls_free()</code> .
</p>
<p>If there is no certificate with the given index,
<code>GNUTLS_E_REQUESTED_DATA_NOT_AVAILABLE</code>  is returned. If the certificate
with the given index is not a X.509 certificate, <code>GNUTLS_E_INVALID_REQUEST</code> 
is returned.
</p>
<p><strong>Returns:</strong> <code>GNUTLS_E_SUCCESS</code>  (0) on success, or a negative error code.
</p>
<p><strong>Since:</strong> 3.4.0
</p></dd></dl>

<a name="gnutls_005fcertificate_005fget_005fopenpgp_005fkey-1"></a>
<h4 class="subheading">gnutls_certificate_get_openpgp_key</h4>
<a name="gnutls_005fcertificate_005fget_005fopenpgp_005fkey"></a><dl>
<dt><a name="index-gnutls_005fcertificate_005fget_005fopenpgp_005fkey"></a>Function: <em>int</em> <strong>gnutls_certificate_get_openpgp_key</strong> <em>(gnutls_certificate_credentials_t <var>res</var>, unsigned <var>index</var>, gnutls_openpgp_privkey_t * <var>key</var>)</em></dt>
<dd><p><var>res</var>: is a <code>gnutls_certificate_credentials_t</code>  type.
</p>
<p><var>index</var>: The index of the key to obtain.
</p>
<p><var>key</var>: Location to store the key.
</p>
<p>Obtains a OpenPGP private key that has been stored in  <code>res</code> with one of
<code>gnutls_certificate_set_openpgp_key()</code> ,
<code>gnutls_certificate_set_openpgp_key_file()</code> ,
<code>gnutls_certificate_set_openpgp_key_file2()</code> ,
<code>gnutls_certificate_set_openpgp_key_mem()</code> , or
<code>gnutls_certificate_set_openpgp_key_mem2()</code> .
The returned key must be deallocated with <code>gnutls_openpgp_privkey_deinit()</code> 
when no longer needed.
</p>
<p>If there is no key with the given index,
<code>GNUTLS_E_REQUESTED_DATA_NOT_AVAILABLE</code>  is returned. If the key with the
given index is not a X.509 key, <code>GNUTLS_E_INVALID_REQUEST</code>  is returned.
</p>
<p><strong>Returns:</strong> <code>GNUTLS_E_SUCCESS</code>  (0) on success, or a negative error code.
</p>
<p><strong>Since:</strong> 3.4.0
</p></dd></dl>

<a name="gnutls_005fcertificate_005fset_005fopenpgp_005fkey-1"></a>
<h4 class="subheading">gnutls_certificate_set_openpgp_key</h4>
<a name="gnutls_005fcertificate_005fset_005fopenpgp_005fkey"></a><dl>
<dt><a name="index-gnutls_005fcertificate_005fset_005fopenpgp_005fkey"></a>Function: <em>int</em> <strong>gnutls_certificate_set_openpgp_key</strong> <em>(gnutls_certificate_credentials_t <var>res</var>, gnutls_openpgp_crt_t <var>crt</var>, gnutls_openpgp_privkey_t <var>pkey</var>)</em></dt>
<dd><p><var>res</var>: is a <code>gnutls_certificate_credentials_t</code>  type.
</p>
<p><var>crt</var>: contains an openpgp public key
</p>
<p><var>pkey</var>: is an openpgp private key
</p>
<p>This function sets a certificate/private key pair in the
gnutls_certificate_credentials_t type.  This function may be
called more than once (in case multiple keys/certificates exist
for the server).
</p>
<p>Note that this function requires that the preferred key ids have
been set and be used. See <code>gnutls_openpgp_crt_set_preferred_key_id()</code> .
Otherwise the master key will be used.
</p>
<p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code>  (0) is returned,
otherwise a negative error code is returned.
</p></dd></dl>

<a name="gnutls_005fcertificate_005fset_005fopenpgp_005fkey_005ffile-1"></a>
<h4 class="subheading">gnutls_certificate_set_openpgp_key_file</h4>
<a name="gnutls_005fcertificate_005fset_005fopenpgp_005fkey_005ffile"></a><dl>
<dt><a name="index-gnutls_005fcertificate_005fset_005fopenpgp_005fkey_005ffile"></a>Function: <em>int</em> <strong>gnutls_certificate_set_openpgp_key_file</strong> <em>(gnutls_certificate_credentials_t      <var>res</var>, const char * <var>certfile</var>, const char * <var>keyfile</var>, gnutls_openpgp_crt_fmt_t <var>format</var>)</em></dt>
<dd><p><var>res</var>: the destination context to save the data.
</p>
<p><var>certfile</var>: the file that contains the public key.
</p>
<p><var>keyfile</var>: the file that contains the secret key.
</p>
<p><var>format</var>: the format of the keys
</p>
<p>This function is used to load OpenPGP keys into the GnuTLS
credentials structure. The file should contain at least one valid non encrypted subkey.
</p>
<p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code>  (0) is returned, otherwise a
negative error value.
</p></dd></dl>

<a name="gnutls_005fcertificate_005fset_005fopenpgp_005fkey_005ffile2-1"></a>
<h4 class="subheading">gnutls_certificate_set_openpgp_key_file2</h4>
<a name="gnutls_005fcertificate_005fset_005fopenpgp_005fkey_005ffile2"></a><dl>
<dt><a name="index-gnutls_005fcertificate_005fset_005fopenpgp_005fkey_005ffile2"></a>Function: <em>int</em> <strong>gnutls_certificate_set_openpgp_key_file2</strong> <em>(gnutls_certificate_credentials_t       <var>res</var>, const char * <var>certfile</var>, const char * <var>keyfile</var>, const char * <var>subkey_id</var>, gnutls_openpgp_crt_fmt_t <var>format</var>)</em></dt>
<dd><p><var>res</var>: the destination context to save the data.
</p>
<p><var>certfile</var>: the file that contains the public key.
</p>
<p><var>keyfile</var>: the file that contains the secret key.
</p>
<p><var>subkey_id</var>: a hex encoded subkey id
</p>
<p><var>format</var>: the format of the keys
</p>
<p>This function is used to load OpenPGP keys into the GnuTLS credential 
structure. The file should contain at least one valid non encrypted subkey.
</p>
<p>The special keyword &quot;auto&quot; is also accepted as  <code>subkey_id</code> .  In that
case the <code>gnutls_openpgp_crt_get_auth_subkey()</code>  will be used to
retrieve the subkey.
</p>
<p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code>  (0) is returned, otherwise a
negative error value.
</p>
<p><strong>Since:</strong> 2.4.0
</p></dd></dl>

<a name="gnutls_005fcertificate_005fset_005fopenpgp_005fkey_005fmem-1"></a>
<h4 class="subheading">gnutls_certificate_set_openpgp_key_mem</h4>
<a name="gnutls_005fcertificate_005fset_005fopenpgp_005fkey_005fmem"></a><dl>
<dt><a name="index-gnutls_005fcertificate_005fset_005fopenpgp_005fkey_005fmem"></a>Function: <em>int</em> <strong>gnutls_certificate_set_openpgp_key_mem</strong> <em>(gnutls_certificate_credentials_t            <var>res</var>, const gnutls_datum_t * <var>cert</var>, const gnutls_datum_t * <var>key</var>, gnutls_openpgp_crt_fmt_t <var>format</var>)</em></dt>
<dd><p><var>res</var>: the destination context to save the data.
</p>
<p><var>cert</var>: the datum that contains the public key.
</p>
<p><var>key</var>: the datum that contains the secret key.
</p>
<p><var>format</var>: the format of the keys
</p>
<p>This function is used to load OpenPGP keys into the GnuTLS credential 
structure. The datum should contain at least one valid non encrypted subkey.
</p>
<p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code>  (0) is returned, otherwise a
negative error value.
</p></dd></dl>

<a name="gnutls_005fcertificate_005fset_005fopenpgp_005fkey_005fmem2-1"></a>
<h4 class="subheading">gnutls_certificate_set_openpgp_key_mem2</h4>
<a name="gnutls_005fcertificate_005fset_005fopenpgp_005fkey_005fmem2"></a><dl>
<dt><a name="index-gnutls_005fcertificate_005fset_005fopenpgp_005fkey_005fmem2"></a>Function: <em>int</em> <strong>gnutls_certificate_set_openpgp_key_mem2</strong> <em>(gnutls_certificate_credentials_t      <var>res</var>, const gnutls_datum_t * <var>cert</var>, const gnutls_datum_t * <var>key</var>, const char * <var>subkey_id</var>, gnutls_openpgp_crt_fmt_t <var>format</var>)</em></dt>
<dd><p><var>res</var>: the destination context to save the data.
</p>
<p><var>cert</var>: the datum that contains the public key.
</p>
<p><var>key</var>: the datum that contains the secret key.
</p>
<p><var>subkey_id</var>: a hex encoded subkey id
</p>
<p><var>format</var>: the format of the keys
</p>
<p>This function is used to load OpenPGP keys into the GnuTLS
credentials structure. The datum should contain at least one valid non encrypted subkey.
</p>
<p>The special keyword &quot;auto&quot; is also accepted as  <code>subkey_id</code> .  In that
case the <code>gnutls_openpgp_crt_get_auth_subkey()</code>  will be used to
retrieve the subkey.
</p>
<p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code>  (0) is returned, otherwise a
negative error value.
</p>
<p><strong>Since:</strong> 2.4.0
</p></dd></dl>

<a name="gnutls_005fcertificate_005fset_005fopenpgp_005fkeyring_005ffile-1"></a>
<h4 class="subheading">gnutls_certificate_set_openpgp_keyring_file</h4>
<a name="gnutls_005fcertificate_005fset_005fopenpgp_005fkeyring_005ffile"></a><dl>
<dt><a name="index-gnutls_005fcertificate_005fset_005fopenpgp_005fkeyring_005ffile-1"></a>Function: <em>int</em> <strong>gnutls_certificate_set_openpgp_keyring_file</strong> <em>(gnutls_certificate_credentials_t <var>c</var>, const char * <var>file</var>, gnutls_openpgp_crt_fmt_t <var>format</var>)</em></dt>
<dd><p><var>c</var>: A certificate credentials structure
</p>
<p><var>file</var>: filename of the keyring.
</p>
<p><var>format</var>: format of keyring.
</p>
<p>The function is used to set keyrings that will be used internally
by various OpenPGP functions. For example to find a key when it
is needed for an operations. The keyring will also be used at the
verification functions.
</p>
<p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code>  (0) is returned, otherwise a
negative error value.
</p></dd></dl>

<a name="gnutls_005fcertificate_005fset_005fopenpgp_005fkeyring_005fmem-1"></a>
<h4 class="subheading">gnutls_certificate_set_openpgp_keyring_mem</h4>
<a name="gnutls_005fcertificate_005fset_005fopenpgp_005fkeyring_005fmem"></a><dl>
<dt><a name="index-gnutls_005fcertificate_005fset_005fopenpgp_005fkeyring_005fmem"></a>Function: <em>int</em> <strong>gnutls_certificate_set_openpgp_keyring_mem</strong> <em>(gnutls_certificate_credentials_t         <var>c</var>, const uint8_t * <var>data</var>, size_t <var>dlen</var>, gnutls_openpgp_crt_fmt_t <var>format</var>)</em></dt>
<dd><p><var>c</var>: A certificate credentials structure
</p>
<p><var>data</var>: buffer with keyring data.
</p>
<p><var>dlen</var>: length of data buffer.
</p>
<p><var>format</var>: the format of the keyring
</p>
<p>The function is used to set keyrings that will be used internally
by various OpenPGP functions. For example to find a key when it
is needed for an operations. The keyring will also be used at the
verification functions.
</p>
<p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code>  (0) is returned, otherwise a
negative error value.
</p></dd></dl>

<a name="gnutls_005fopenpgp_005fcrt_005fcheck_005femail-1"></a>
<h4 class="subheading">gnutls_openpgp_crt_check_email</h4>
<a name="gnutls_005fopenpgp_005fcrt_005fcheck_005femail"></a><dl>
<dt><a name="index-gnutls_005fopenpgp_005fcrt_005fcheck_005femail"></a>Function: <em>int</em> <strong>gnutls_openpgp_crt_check_email</strong> <em>(gnutls_openpgp_crt_t <var>key</var>, const char * <var>email</var>, unsigned <var>flags</var>)</em></dt>
<dd><p><var>key</var>: should contain a <code>gnutls_openpgp_crt_t</code>  type
</p>
<p><var>email</var>: A null terminated string that contains an RFC822 address (email)
</p>
<p><var>flags</var>: gnutls_certificate_verify_flags
</p>
<p>This function will check if the given key&rsquo;s owner matches the
given email address. 
</p>
<p><strong>Returns:</strong> non-zero for a successful match, and zero on failure.
</p></dd></dl>

<a name="gnutls_005fopenpgp_005fcrt_005fcheck_005fhostname-1"></a>
<h4 class="subheading">gnutls_openpgp_crt_check_hostname</h4>
<a name="gnutls_005fopenpgp_005fcrt_005fcheck_005fhostname"></a><dl>
<dt><a name="index-gnutls_005fopenpgp_005fcrt_005fcheck_005fhostname"></a>Function: <em>int</em> <strong>gnutls_openpgp_crt_check_hostname</strong> <em>(gnutls_openpgp_crt_t <var>key</var>, const char * <var>hostname</var>)</em></dt>
<dd><p><var>key</var>: should contain a <code>gnutls_openpgp_crt_t</code>  type
</p>
<p><var>hostname</var>: A null terminated string that contains a DNS name
</p>
<p>This function will check if the given key&rsquo;s owner matches the
given hostname. This is a basic implementation of the matching
described in RFC2818 (HTTPS), which takes into account wildcards.
</p>
<p><strong>Returns:</strong> non-zero for a successful match, and zero on failure.
</p></dd></dl>

<a name="gnutls_005fopenpgp_005fcrt_005fcheck_005fhostname2-1"></a>
<h4 class="subheading">gnutls_openpgp_crt_check_hostname2</h4>
<a name="gnutls_005fopenpgp_005fcrt_005fcheck_005fhostname2"></a><dl>
<dt><a name="index-gnutls_005fopenpgp_005fcrt_005fcheck_005fhostname2"></a>Function: <em>int</em> <strong>gnutls_openpgp_crt_check_hostname2</strong> <em>(gnutls_openpgp_crt_t <var>key</var>, const char * <var>hostname</var>, unsigned <var>flags</var>)</em></dt>
<dd><p><var>key</var>: should contain a <code>gnutls_openpgp_crt_t</code>  type
</p>
<p><var>hostname</var>: A null terminated string that contains a DNS name
</p>
<p><var>flags</var>: gnutls_certificate_verify_flags
</p>
<p>This function will check if the given key&rsquo;s owner matches the
given hostname. 
</p>
<p>Unless, the flag <code>GNUTLS_VERIFY_DO_NOT_ALLOW_WILDCARDS</code>  is specified,
wildcards are only considered if the domain name consists of three
components or more, and the wildcard starts at the leftmost position.
</p>
<p><strong>Returns:</strong> non-zero for a successful match, and zero on failure.
</p></dd></dl>

<a name="gnutls_005fopenpgp_005fcrt_005fdeinit-1"></a>
<h4 class="subheading">gnutls_openpgp_crt_deinit</h4>
<a name="gnutls_005fopenpgp_005fcrt_005fdeinit"></a><dl>
<dt><a name="index-gnutls_005fopenpgp_005fcrt_005fdeinit"></a>Function: <em>void</em> <strong>gnutls_openpgp_crt_deinit</strong> <em>(gnutls_openpgp_crt_t <var>key</var>)</em></dt>
<dd><p><var>key</var>: A pointer to the type to be initialized
</p>
<p>This function will deinitialize a key structure.
</p></dd></dl>

<a name="gnutls_005fopenpgp_005fcrt_005fexport-1"></a>
<h4 class="subheading">gnutls_openpgp_crt_export</h4>
<a name="gnutls_005fopenpgp_005fcrt_005fexport"></a><dl>
<dt><a name="index-gnutls_005fopenpgp_005fcrt_005fexport"></a>Function: <em>int</em> <strong>gnutls_openpgp_crt_export</strong> <em>(gnutls_openpgp_crt_t <var>key</var>, gnutls_openpgp_crt_fmt_t <var>format</var>, void * <var>output_data</var>, size_t * <var>output_data_size</var>)</em></dt>
<dd><p><var>key</var>: Holds the key.
</p>
<p><var>format</var>: One of gnutls_openpgp_crt_fmt_t elements.
</p>
<p><var>output_data</var>: will contain the raw or base64 encoded key
</p>
<p><var>output_data_size</var>: holds the size of output_data (and will
be replaced by the actual size of parameters)
</p>
<p>This function will convert the given key to RAW or Base64 format.
If the buffer provided is not long enough to hold the output, then
<code>GNUTLS_E_SHORT_MEMORY_BUFFER</code>  will be returned.
</p>
<p><strong>Returns:</strong> <code>GNUTLS_E_SUCCESS</code>  on success, or an error code.
</p></dd></dl>

<a name="gnutls_005fopenpgp_005fcrt_005fexport2-1"></a>
<h4 class="subheading">gnutls_openpgp_crt_export2</h4>
<a name="gnutls_005fopenpgp_005fcrt_005fexport2"></a><dl>
<dt><a name="index-gnutls_005fopenpgp_005fcrt_005fexport2"></a>Function: <em>int</em> <strong>gnutls_openpgp_crt_export2</strong> <em>(gnutls_openpgp_crt_t <var>key</var>, gnutls_openpgp_crt_fmt_t <var>format</var>, gnutls_datum_t * <var>out</var>)</em></dt>
<dd><p><var>key</var>: Holds the key.
</p>
<p><var>format</var>: One of gnutls_openpgp_crt_fmt_t elements.
</p>
<p><var>out</var>: will contain the raw or base64 encoded key
</p>
<p>This function will convert the given key to RAW or Base64 format.
The output buffer is allocated using <code>gnutls_malloc()</code> .
</p>
<p><strong>Returns:</strong> <code>GNUTLS_E_SUCCESS</code>  on success, or an error code.
</p>
<p><strong>Since:</strong> 3.1.3
</p></dd></dl>

<a name="gnutls_005fopenpgp_005fcrt_005fget_005fauth_005fsubkey-1"></a>
<h4 class="subheading">gnutls_openpgp_crt_get_auth_subkey</h4>
<a name="gnutls_005fopenpgp_005fcrt_005fget_005fauth_005fsubkey"></a><dl>
<dt><a name="index-gnutls_005fopenpgp_005fcrt_005fget_005fauth_005fsubkey"></a>Function: <em>int</em> <strong>gnutls_openpgp_crt_get_auth_subkey</strong> <em>(gnutls_openpgp_crt_t <var>crt</var>, gnutls_openpgp_keyid_t <var>keyid</var>, unsigned int <var>flag</var>)</em></dt>
<dd><p><var>crt</var>: the structure that contains the OpenPGP public key.
</p>
<p><var>keyid</var>: the struct to save the keyid.
</p>
<p><var>flag</var>: Non-zero indicates that a valid subkey is always returned.
</p>
<p>Returns the 64-bit keyID of the first valid OpenPGP subkey marked
for authentication.  If flag is non-zero and no authentication
subkey exists, then a valid subkey will be returned even if it is
not marked for authentication.
</p>
<p><strong>Returns:</strong> <code>GNUTLS_E_SUCCESS</code>  on success, or an error code.
</p></dd></dl>

<a name="gnutls_005fopenpgp_005fcrt_005fget_005fcreation_005ftime-1"></a>
<h4 class="subheading">gnutls_openpgp_crt_get_creation_time</h4>
<a name="gnutls_005fopenpgp_005fcrt_005fget_005fcreation_005ftime"></a><dl>
<dt><a name="index-gnutls_005fopenpgp_005fcrt_005fget_005fcreation_005ftime"></a>Function: <em>time_t</em> <strong>gnutls_openpgp_crt_get_creation_time</strong> <em>(gnutls_openpgp_crt_t <var>key</var>)</em></dt>
<dd><p><var>key</var>: the structure that contains the OpenPGP public key.
</p>
<p>Get key creation time.
</p>
<p><strong>Returns:</strong> the timestamp when the OpenPGP key was created.
</p></dd></dl>

<a name="gnutls_005fopenpgp_005fcrt_005fget_005fexpiration_005ftime-1"></a>
<h4 class="subheading">gnutls_openpgp_crt_get_expiration_time</h4>
<a name="gnutls_005fopenpgp_005fcrt_005fget_005fexpiration_005ftime"></a><dl>
<dt><a name="index-gnutls_005fopenpgp_005fcrt_005fget_005fexpiration_005ftime"></a>Function: <em>time_t</em> <strong>gnutls_openpgp_crt_get_expiration_time</strong> <em>(gnutls_openpgp_crt_t <var>key</var>)</em></dt>
<dd><p><var>key</var>: the structure that contains the OpenPGP public key.
</p>
<p>Get key expiration time.  A value of &rsquo;0&rsquo; means that the key doesn&rsquo;t
expire at all.
</p>
<p><strong>Returns:</strong> the time when the OpenPGP key expires.
</p></dd></dl>

<a name="gnutls_005fopenpgp_005fcrt_005fget_005ffingerprint-1"></a>
<h4 class="subheading">gnutls_openpgp_crt_get_fingerprint</h4>
<a name="gnutls_005fopenpgp_005fcrt_005fget_005ffingerprint"></a><dl>
<dt><a name="index-gnutls_005fopenpgp_005fcrt_005fget_005ffingerprint"></a>Function: <em>int</em> <strong>gnutls_openpgp_crt_get_fingerprint</strong> <em>(gnutls_openpgp_crt_t <var>key</var>, void * <var>fpr</var>, size_t * <var>fprlen</var>)</em></dt>
<dd><p><var>key</var>: the raw data that contains the OpenPGP public key.
</p>
<p><var>fpr</var>: the buffer to save the fingerprint, must hold at least 20 bytes.
</p>
<p><var>fprlen</var>: the integer to save the length of the fingerprint.
</p>
<p>Get key fingerprint.  Depending on the algorithm, the fingerprint
can be 16 or 20 bytes.
</p>
<p><strong>Returns:</strong> On success, 0 is returned.  Otherwise, an error code.
</p></dd></dl>

<a name="gnutls_005fopenpgp_005fcrt_005fget_005fkey_005fid-1"></a>
<h4 class="subheading">gnutls_openpgp_crt_get_key_id</h4>
<a name="gnutls_005fopenpgp_005fcrt_005fget_005fkey_005fid"></a><dl>
<dt><a name="index-gnutls_005fopenpgp_005fcrt_005fget_005fkey_005fid"></a>Function: <em>int</em> <strong>gnutls_openpgp_crt_get_key_id</strong> <em>(gnutls_openpgp_crt_t <var>key</var>, gnutls_openpgp_keyid_t <var>keyid</var>)</em></dt>
<dd><p><var>key</var>: the structure that contains the OpenPGP public key.
</p>
<p><var>keyid</var>: the buffer to save the keyid.
</p>
<p>Get key id string.
</p>
<p><strong>Returns:</strong> the 64-bit keyID of the OpenPGP key.
</p>
<p><strong>Since:</strong> 2.4.0
</p></dd></dl>

<a name="gnutls_005fopenpgp_005fcrt_005fget_005fkey_005fusage-1"></a>
<h4 class="subheading">gnutls_openpgp_crt_get_key_usage</h4>
<a name="gnutls_005fopenpgp_005fcrt_005fget_005fkey_005fusage"></a><dl>
<dt><a name="index-gnutls_005fopenpgp_005fcrt_005fget_005fkey_005fusage"></a>Function: <em>int</em> <strong>gnutls_openpgp_crt_get_key_usage</strong> <em>(gnutls_openpgp_crt_t <var>key</var>, unsigned int * <var>key_usage</var>)</em></dt>
<dd><p><var>key</var>: should contain a gnutls_openpgp_crt_t type
</p>
<p><var>key_usage</var>: where the key usage bits will be stored
</p>
<p>This function will return certificate&rsquo;s key usage, by checking the
key algorithm. The key usage value will ORed values of the:
<code>GNUTLS_KEY_DIGITAL_SIGNATURE</code> , <code>GNUTLS_KEY_KEY_ENCIPHERMENT</code> .
</p>
<p><strong>Returns:</strong> <code>GNUTLS_E_SUCCESS</code>  on success, or an error code.
</p></dd></dl>

<a name="gnutls_005fopenpgp_005fcrt_005fget_005fname-1"></a>
<h4 class="subheading">gnutls_openpgp_crt_get_name</h4>
<a name="gnutls_005fopenpgp_005fcrt_005fget_005fname"></a><dl>
<dt><a name="index-gnutls_005fopenpgp_005fcrt_005fget_005fname"></a>Function: <em>int</em> <strong>gnutls_openpgp_crt_get_name</strong> <em>(gnutls_openpgp_crt_t <var>key</var>, int <var>idx</var>, char * <var>buf</var>, size_t * <var>sizeof_buf</var>)</em></dt>
<dd><p><var>key</var>: the structure that contains the OpenPGP public key.
</p>
<p><var>idx</var>: the index of the ID to extract
</p>
<p><var>buf</var>: a pointer to a structure to hold the name, may be <code>NULL</code> 
to only get the  <code>sizeof_buf</code> .
</p>
<p><var>sizeof_buf</var>: holds the maximum size of  <code>buf</code> , on return hold the
actual/required size of  <code>buf</code> .
</p>
<p>Extracts the userID from the parsed OpenPGP key.
</p>
<p><strong>Returns:</strong> <code>GNUTLS_E_SUCCESS</code>  on success, and if the index of the ID
does not exist <code>GNUTLS_E_REQUESTED_DATA_NOT_AVAILABLE</code> , or an
error code.
</p></dd></dl>

<a name="gnutls_005fopenpgp_005fcrt_005fget_005fpk_005falgorithm-1"></a>
<h4 class="subheading">gnutls_openpgp_crt_get_pk_algorithm</h4>
<a name="gnutls_005fopenpgp_005fcrt_005fget_005fpk_005falgorithm"></a><dl>
<dt><a name="index-gnutls_005fopenpgp_005fcrt_005fget_005fpk_005falgorithm"></a>Function: <em>gnutls_pk_algorithm_t</em> <strong>gnutls_openpgp_crt_get_pk_algorithm</strong> <em>(gnutls_openpgp_crt_t <var>key</var>, unsigned int * <var>bits</var>)</em></dt>
<dd><p><var>key</var>: is an OpenPGP key
</p>
<p><var>bits</var>: if bits is non null it will hold the size of the parameters&rsquo; in bits
</p>
<p>This function will return the public key algorithm of an OpenPGP
certificate.
</p>
<p>If bits is non null, it should have enough size to hold the parameters
size in bits. For RSA the bits returned is the modulus.
For DSA the bits returned are of the public exponent.
</p>
<p><strong>Returns:</strong> a member of the <code>gnutls_pk_algorithm_t</code>  enumeration on
success, or GNUTLS_PK_UNKNOWN on error.
</p></dd></dl>

<a name="gnutls_005fopenpgp_005fcrt_005fget_005fpk_005fdsa_005fraw-1"></a>
<h4 class="subheading">gnutls_openpgp_crt_get_pk_dsa_raw</h4>
<a name="gnutls_005fopenpgp_005fcrt_005fget_005fpk_005fdsa_005fraw"></a><dl>
<dt><a name="index-gnutls_005fopenpgp_005fcrt_005fget_005fpk_005fdsa_005fraw"></a>Function: <em>int</em> <strong>gnutls_openpgp_crt_get_pk_dsa_raw</strong> <em>(gnutls_openpgp_crt_t <var>crt</var>, gnutls_datum_t * <var>p</var>, gnutls_datum_t * <var>q</var>, gnutls_datum_t * <var>g</var>, gnutls_datum_t * <var>y</var>)</em></dt>
<dd><p><var>crt</var>: Holds the certificate
</p>
<p><var>p</var>: will hold the p
</p>
<p><var>q</var>: will hold the q
</p>
<p><var>g</var>: will hold the g
</p>
<p><var>y</var>: will hold the y
</p>
<p>This function will export the DSA public key&rsquo;s parameters found in
the given certificate.  The new parameters will be allocated using
<code>gnutls_malloc()</code>  and will be stored in the appropriate datum.
</p>
<p><strong>Returns:</strong> <code>GNUTLS_E_SUCCESS</code>  on success, otherwise a negative error code.
</p>
<p><strong>Since:</strong> 2.4.0
</p></dd></dl>

<a name="gnutls_005fopenpgp_005fcrt_005fget_005fpk_005frsa_005fraw-1"></a>
<h4 class="subheading">gnutls_openpgp_crt_get_pk_rsa_raw</h4>
<a name="gnutls_005fopenpgp_005fcrt_005fget_005fpk_005frsa_005fraw"></a><dl>
<dt><a name="index-gnutls_005fopenpgp_005fcrt_005fget_005fpk_005frsa_005fraw"></a>Function: <em>int</em> <strong>gnutls_openpgp_crt_get_pk_rsa_raw</strong> <em>(gnutls_openpgp_crt_t <var>crt</var>, gnutls_datum_t * <var>m</var>, gnutls_datum_t * <var>e</var>)</em></dt>
<dd><p><var>crt</var>: Holds the certificate
</p>
<p><var>m</var>: will hold the modulus
</p>
<p><var>e</var>: will hold the public exponent
</p>
<p>This function will export the RSA public key&rsquo;s parameters found in
the given structure.  The new parameters will be allocated using
<code>gnutls_malloc()</code>  and will be stored in the appropriate datum.
</p>
<p><strong>Returns:</strong> <code>GNUTLS_E_SUCCESS</code>  on success, otherwise a negative error code.
</p>
<p><strong>Since:</strong> 2.4.0
</p></dd></dl>

<a name="gnutls_005fopenpgp_005fcrt_005fget_005fpreferred_005fkey_005fid-1"></a>
<h4 class="subheading">gnutls_openpgp_crt_get_preferred_key_id</h4>
<a name="gnutls_005fopenpgp_005fcrt_005fget_005fpreferred_005fkey_005fid"></a><dl>
<dt><a name="index-gnutls_005fopenpgp_005fcrt_005fget_005fpreferred_005fkey_005fid"></a>Function: <em>int</em> <strong>gnutls_openpgp_crt_get_preferred_key_id</strong> <em>(gnutls_openpgp_crt_t <var>key</var>, gnutls_openpgp_keyid_t <var>keyid</var>)</em></dt>
<dd><p><var>key</var>: the structure that contains the OpenPGP public key.
</p>
<p><var>keyid</var>: the struct to save the keyid.
</p>
<p>Get preferred key id.  If it hasn&rsquo;t been set it returns
<code>GNUTLS_E_INVALID_REQUEST</code> .
</p>
<p><strong>Returns:</strong> the 64-bit preferred keyID of the OpenPGP key.
</p></dd></dl>

<a name="gnutls_005fopenpgp_005fcrt_005fget_005frevoked_005fstatus-1"></a>
<h4 class="subheading">gnutls_openpgp_crt_get_revoked_status</h4>
<a name="gnutls_005fopenpgp_005fcrt_005fget_005frevoked_005fstatus"></a><dl>
<dt><a name="index-gnutls_005fopenpgp_005fcrt_005fget_005frevoked_005fstatus"></a>Function: <em>int</em> <strong>gnutls_openpgp_crt_get_revoked_status</strong> <em>(gnutls_openpgp_crt_t <var>key</var>)</em></dt>
<dd><p><var>key</var>: the structure that contains the OpenPGP public key.
</p>
<p>Get revocation status of key.
</p>
<p><strong>Returns:</strong> true (1) if the key has been revoked, or false (0) if it
has not.
</p>
<p><strong>Since:</strong> 2.4.0
</p></dd></dl>

<a name="gnutls_005fopenpgp_005fcrt_005fget_005fsubkey_005fcount-1"></a>
<h4 class="subheading">gnutls_openpgp_crt_get_subkey_count</h4>
<a name="gnutls_005fopenpgp_005fcrt_005fget_005fsubkey_005fcount"></a><dl>
<dt><a name="index-gnutls_005fopenpgp_005fcrt_005fget_005fsubkey_005fcount"></a>Function: <em>int</em> <strong>gnutls_openpgp_crt_get_subkey_count</strong> <em>(gnutls_openpgp_crt_t <var>key</var>)</em></dt>
<dd><p><var>key</var>: is an OpenPGP key
</p>
<p>This function will return the number of subkeys present in the
given OpenPGP certificate.
</p>
<p><strong>Returns:</strong> the number of subkeys, or a negative error code on error.
</p>
<p><strong>Since:</strong> 2.4.0
</p></dd></dl>

<a name="gnutls_005fopenpgp_005fcrt_005fget_005fsubkey_005fcreation_005ftime-1"></a>
<h4 class="subheading">gnutls_openpgp_crt_get_subkey_creation_time</h4>
<a name="gnutls_005fopenpgp_005fcrt_005fget_005fsubkey_005fcreation_005ftime"></a><dl>
<dt><a name="index-gnutls_005fopenpgp_005fcrt_005fget_005fsubkey_005fcreation_005ftime"></a>Function: <em>time_t</em> <strong>gnutls_openpgp_crt_get_subkey_creation_time</strong> <em>(gnutls_openpgp_crt_t <var>key</var>, unsigned int <var>idx</var>)</em></dt>
<dd><p><var>key</var>: the structure that contains the OpenPGP public key.
</p>
<p><var>idx</var>: the subkey index
</p>
<p>Get subkey creation time.
</p>
<p><strong>Returns:</strong> the timestamp when the OpenPGP sub-key was created.
</p>
<p><strong>Since:</strong> 2.4.0
</p></dd></dl>

<a name="gnutls_005fopenpgp_005fcrt_005fget_005fsubkey_005fexpiration_005ftime-1"></a>
<h4 class="subheading">gnutls_openpgp_crt_get_subkey_expiration_time</h4>
<a name="gnutls_005fopenpgp_005fcrt_005fget_005fsubkey_005fexpiration_005ftime"></a><dl>
<dt><a name="index-gnutls_005fopenpgp_005fcrt_005fget_005fsubkey_005fexpiration_005ftime"></a>Function: <em>time_t</em> <strong>gnutls_openpgp_crt_get_subkey_expiration_time</strong> <em>(gnutls_openpgp_crt_t <var>key</var>, unsigned int <var>idx</var>)</em></dt>
<dd><p><var>key</var>: the structure that contains the OpenPGP public key.
</p>
<p><var>idx</var>: the subkey index
</p>
<p>Get subkey expiration time.  A value of &rsquo;0&rsquo; means that the key
doesn&rsquo;t expire at all.
</p>
<p><strong>Returns:</strong> the time when the OpenPGP key expires.
</p>
<p><strong>Since:</strong> 2.4.0
</p></dd></dl>

<a name="gnutls_005fopenpgp_005fcrt_005fget_005fsubkey_005ffingerprint-1"></a>
<h4 class="subheading">gnutls_openpgp_crt_get_subkey_fingerprint</h4>
<a name="gnutls_005fopenpgp_005fcrt_005fget_005fsubkey_005ffingerprint"></a><dl>
<dt><a name="index-gnutls_005fopenpgp_005fcrt_005fget_005fsubkey_005ffingerprint"></a>Function: <em>int</em> <strong>gnutls_openpgp_crt_get_subkey_fingerprint</strong> <em>(gnutls_openpgp_crt_t <var>key</var>, unsigned int <var>idx</var>, void * <var>fpr</var>, size_t * <var>fprlen</var>)</em></dt>
<dd><p><var>key</var>: the raw data that contains the OpenPGP public key.
</p>
<p><var>idx</var>: the subkey index
</p>
<p><var>fpr</var>: the buffer to save the fingerprint, must hold at least 20 bytes.
</p>
<p><var>fprlen</var>: the integer to save the length of the fingerprint.
</p>
<p>Get key fingerprint of a subkey.  Depending on the algorithm, the
fingerprint can be 16 or 20 bytes.
</p>
<p><strong>Returns:</strong> On success, 0 is returned.  Otherwise, an error code.
</p>
<p><strong>Since:</strong> 2.4.0
</p></dd></dl>

<a name="gnutls_005fopenpgp_005fcrt_005fget_005fsubkey_005fid-1"></a>
<h4 class="subheading">gnutls_openpgp_crt_get_subkey_id</h4>
<a name="gnutls_005fopenpgp_005fcrt_005fget_005fsubkey_005fid"></a><dl>
<dt><a name="index-gnutls_005fopenpgp_005fcrt_005fget_005fsubkey_005fid"></a>Function: <em>int</em> <strong>gnutls_openpgp_crt_get_subkey_id</strong> <em>(gnutls_openpgp_crt_t <var>key</var>, unsigned int <var>idx</var>, gnutls_openpgp_keyid_t <var>keyid</var>)</em></dt>
<dd><p><var>key</var>: the structure that contains the OpenPGP public key.
</p>
<p><var>idx</var>: the subkey index
</p>
<p><var>keyid</var>: the buffer to save the keyid.
</p>
<p>Get the subkey&rsquo;s key-id.
</p>
<p><strong>Returns:</strong> the 64-bit keyID of the OpenPGP key.
</p></dd></dl>

<a name="gnutls_005fopenpgp_005fcrt_005fget_005fsubkey_005fidx-1"></a>
<h4 class="subheading">gnutls_openpgp_crt_get_subkey_idx</h4>
<a name="gnutls_005fopenpgp_005fcrt_005fget_005fsubkey_005fidx"></a><dl>
<dt><a name="index-gnutls_005fopenpgp_005fcrt_005fget_005fsubkey_005fidx"></a>Function: <em>int</em> <strong>gnutls_openpgp_crt_get_subkey_idx</strong> <em>(gnutls_openpgp_crt_t <var>key</var>, const gnutls_openpgp_keyid_t <var>keyid</var>)</em></dt>
<dd><p><var>key</var>: the structure that contains the OpenPGP public key.
</p>
<p><var>keyid</var>: the keyid.
</p>
<p>Get subkey&rsquo;s index.
</p>
<p><strong>Returns:</strong> the index of the subkey or a negative error value.
</p>
<p><strong>Since:</strong> 2.4.0
</p></dd></dl>

<a name="gnutls_005fopenpgp_005fcrt_005fget_005fsubkey_005fpk_005falgorithm-1"></a>
<h4 class="subheading">gnutls_openpgp_crt_get_subkey_pk_algorithm</h4>
<a name="gnutls_005fopenpgp_005fcrt_005fget_005fsubkey_005fpk_005falgorithm"></a><dl>
<dt><a name="index-gnutls_005fopenpgp_005fcrt_005fget_005fsubkey_005fpk_005falgorithm"></a>Function: <em>gnutls_pk_algorithm_t</em> <strong>gnutls_openpgp_crt_get_subkey_pk_algorithm</strong> <em>(gnutls_openpgp_crt_t <var>key</var>, unsigned int <var>idx</var>, unsigned int * <var>bits</var>)</em></dt>
<dd><p><var>key</var>: is an OpenPGP key
</p>
<p><var>idx</var>: is the subkey index
</p>
<p><var>bits</var>: if bits is non null it will hold the size of the parameters&rsquo; in bits
</p>
<p>This function will return the public key algorithm of a subkey of an OpenPGP
certificate.
</p>
<p>If bits is non null, it should have enough size to hold the
parameters size in bits.  For RSA the bits returned is the modulus.
For DSA the bits returned are of the public exponent.
</p>
<p><strong>Returns:</strong> a member of the <code>gnutls_pk_algorithm_t</code>  enumeration on
success, or GNUTLS_PK_UNKNOWN on error.
</p>
<p><strong>Since:</strong> 2.4.0
</p></dd></dl>

<a name="gnutls_005fopenpgp_005fcrt_005fget_005fsubkey_005fpk_005fdsa_005fraw-1"></a>
<h4 class="subheading">gnutls_openpgp_crt_get_subkey_pk_dsa_raw</h4>
<a name="gnutls_005fopenpgp_005fcrt_005fget_005fsubkey_005fpk_005fdsa_005fraw"></a><dl>
<dt><a name="index-gnutls_005fopenpgp_005fcrt_005fget_005fsubkey_005fpk_005fdsa_005fraw"></a>Function: <em>int</em> <strong>gnutls_openpgp_crt_get_subkey_pk_dsa_raw</strong> <em>(gnutls_openpgp_crt_t <var>crt</var>, unsigned int <var>idx</var>, gnutls_datum_t * <var>p</var>, gnutls_datum_t * <var>q</var>, gnutls_datum_t * <var>g</var>, gnutls_datum_t * <var>y</var>)</em></dt>
<dd><p><var>crt</var>: Holds the certificate
</p>
<p><var>idx</var>: Is the subkey index
</p>
<p><var>p</var>: will hold the p
</p>
<p><var>q</var>: will hold the q
</p>
<p><var>g</var>: will hold the g
</p>
<p><var>y</var>: will hold the y
</p>
<p>This function will export the DSA public key&rsquo;s parameters found in
the given certificate.  The new parameters will be allocated using
<code>gnutls_malloc()</code>  and will be stored in the appropriate datum.
</p>
<p><strong>Returns:</strong> <code>GNUTLS_E_SUCCESS</code>  on success, otherwise a negative error code.
</p>
<p><strong>Since:</strong> 2.4.0
</p></dd></dl>

<a name="gnutls_005fopenpgp_005fcrt_005fget_005fsubkey_005fpk_005frsa_005fraw-1"></a>
<h4 class="subheading">gnutls_openpgp_crt_get_subkey_pk_rsa_raw</h4>
<a name="gnutls_005fopenpgp_005fcrt_005fget_005fsubkey_005fpk_005frsa_005fraw"></a><dl>
<dt><a name="index-gnutls_005fopenpgp_005fcrt_005fget_005fsubkey_005fpk_005frsa_005fraw"></a>Function: <em>int</em> <strong>gnutls_openpgp_crt_get_subkey_pk_rsa_raw</strong> <em>(gnutls_openpgp_crt_t <var>crt</var>, unsigned int <var>idx</var>, gnutls_datum_t * <var>m</var>, gnutls_datum_t * <var>e</var>)</em></dt>
<dd><p><var>crt</var>: Holds the certificate
</p>
<p><var>idx</var>: Is the subkey index
</p>
<p><var>m</var>: will hold the modulus
</p>
<p><var>e</var>: will hold the public exponent
</p>
<p>This function will export the RSA public key&rsquo;s parameters found in
the given structure.  The new parameters will be allocated using
<code>gnutls_malloc()</code>  and will be stored in the appropriate datum.
</p>
<p><strong>Returns:</strong> <code>GNUTLS_E_SUCCESS</code>  on success, otherwise a negative error code.
</p>
<p><strong>Since:</strong> 2.4.0
</p></dd></dl>

<a name="gnutls_005fopenpgp_005fcrt_005fget_005fsubkey_005frevoked_005fstatus-1"></a>
<h4 class="subheading">gnutls_openpgp_crt_get_subkey_revoked_status</h4>
<a name="gnutls_005fopenpgp_005fcrt_005fget_005fsubkey_005frevoked_005fstatus"></a><dl>
<dt><a name="index-gnutls_005fopenpgp_005fcrt_005fget_005fsubkey_005frevoked_005fstatus"></a>Function: <em>int</em> <strong>gnutls_openpgp_crt_get_subkey_revoked_status</strong> <em>(gnutls_openpgp_crt_t <var>key</var>, unsigned int <var>idx</var>)</em></dt>
<dd><p><var>key</var>: the structure that contains the OpenPGP public key.
</p>
<p><var>idx</var>: is the subkey index
</p>
<p>Get subkey revocation status.  A negative error code indicates an error.
</p>
<p><strong>Returns:</strong> true (1) if the key has been revoked, or false (0) if it
has not.
</p>
<p><strong>Since:</strong> 2.4.0
</p></dd></dl>

<a name="gnutls_005fopenpgp_005fcrt_005fget_005fsubkey_005fusage-1"></a>
<h4 class="subheading">gnutls_openpgp_crt_get_subkey_usage</h4>
<a name="gnutls_005fopenpgp_005fcrt_005fget_005fsubkey_005fusage"></a><dl>
<dt><a name="index-gnutls_005fopenpgp_005fcrt_005fget_005fsubkey_005fusage"></a>Function: <em>int</em> <strong>gnutls_openpgp_crt_get_subkey_usage</strong> <em>(gnutls_openpgp_crt_t <var>key</var>, unsigned int <var>idx</var>, unsigned int * <var>key_usage</var>)</em></dt>
<dd><p><var>key</var>: should contain a gnutls_openpgp_crt_t type
</p>
<p><var>idx</var>: the subkey index
</p>
<p><var>key_usage</var>: where the key usage bits will be stored
</p>
<p>This function will return certificate&rsquo;s key usage, by checking the
key algorithm.  The key usage value will ORed values of
<code>GNUTLS_KEY_DIGITAL_SIGNATURE</code>  or <code>GNUTLS_KEY_KEY_ENCIPHERMENT</code> .
</p>
<p>A negative error code may be returned in case of parsing error.
</p>
<p><strong>Returns:</strong> key usage value.
</p>
<p><strong>Since:</strong> 2.4.0
</p></dd></dl>

<a name="gnutls_005fopenpgp_005fcrt_005fget_005fversion-1"></a>
<h4 class="subheading">gnutls_openpgp_crt_get_version</h4>
<a name="gnutls_005fopenpgp_005fcrt_005fget_005fversion"></a><dl>
<dt><a name="index-gnutls_005fopenpgp_005fcrt_005fget_005fversion"></a>Function: <em>int</em> <strong>gnutls_openpgp_crt_get_version</strong> <em>(gnutls_openpgp_crt_t <var>key</var>)</em></dt>
<dd><p><var>key</var>: the structure that contains the OpenPGP public key.
</p>
<p>Extract the version of the OpenPGP key.
</p>
<p><strong>Returns:</strong> the version number is returned, or a negative error code on errors.
</p></dd></dl>

<a name="gnutls_005fopenpgp_005fcrt_005fimport-1"></a>
<h4 class="subheading">gnutls_openpgp_crt_import</h4>
<a name="gnutls_005fopenpgp_005fcrt_005fimport"></a><dl>
<dt><a name="index-gnutls_005fopenpgp_005fcrt_005fimport"></a>Function: <em>int</em> <strong>gnutls_openpgp_crt_import</strong> <em>(gnutls_openpgp_crt_t <var>key</var>, const gnutls_datum_t * <var>data</var>, gnutls_openpgp_crt_fmt_t <var>format</var>)</em></dt>
<dd><p><var>key</var>: The structure to store the parsed key.
</p>
<p><var>data</var>: The RAW or BASE64 encoded key.
</p>
<p><var>format</var>: One of gnutls_openpgp_crt_fmt_t elements.
</p>
<p>This function will convert the given RAW or Base64 encoded key to
the native <code>gnutls_openpgp_crt_t</code>  format. The output will be stored
in &rsquo;key&rsquo;.
</p>
<p><strong>Returns:</strong> <code>GNUTLS_E_SUCCESS</code>  on success, or an error code.
</p></dd></dl>

<a name="gnutls_005fopenpgp_005fcrt_005finit-1"></a>
<h4 class="subheading">gnutls_openpgp_crt_init</h4>
<a name="gnutls_005fopenpgp_005fcrt_005finit"></a><dl>
<dt><a name="index-gnutls_005fopenpgp_005fcrt_005finit"></a>Function: <em>int</em> <strong>gnutls_openpgp_crt_init</strong> <em>(gnutls_openpgp_crt_t * <var>key</var>)</em></dt>
<dd><p><var>key</var>: A pointer to the type to be initialized
</p>
<p>This function will initialize an OpenPGP key structure.
</p>
<p><strong>Returns:</strong> <code>GNUTLS_E_SUCCESS</code>  on success, or an error code.
</p></dd></dl>

<a name="gnutls_005fopenpgp_005fcrt_005fprint-1"></a>
<h4 class="subheading">gnutls_openpgp_crt_print</h4>
<a name="gnutls_005fopenpgp_005fcrt_005fprint"></a><dl>
<dt><a name="index-gnutls_005fopenpgp_005fcrt_005fprint"></a>Function: <em>int</em> <strong>gnutls_openpgp_crt_print</strong> <em>(gnutls_openpgp_crt_t <var>cert</var>, gnutls_certificate_print_formats_t <var>format</var>, gnutls_datum_t * <var>out</var>)</em></dt>
<dd><p><var>cert</var>: The structure to be printed
</p>
<p><var>format</var>: Indicate the format to use
</p>
<p><var>out</var>: Newly allocated datum with (0) terminated string.
</p>
<p>This function will pretty print an OpenPGP certificate, suitable
for display to a human.
</p>
<p>The format should be (0) for future compatibility.
</p>
<p>The output  <code>out</code> needs to be deallocate using <code>gnutls_free()</code> .
</p>
<p><strong>Returns:</strong> <code>GNUTLS_E_SUCCESS</code>  on success, or an error code.
</p></dd></dl>

<a name="gnutls_005fopenpgp_005fcrt_005fset_005fpreferred_005fkey_005fid-1"></a>
<h4 class="subheading">gnutls_openpgp_crt_set_preferred_key_id</h4>
<a name="gnutls_005fopenpgp_005fcrt_005fset_005fpreferred_005fkey_005fid"></a><dl>
<dt><a name="index-gnutls_005fopenpgp_005fcrt_005fset_005fpreferred_005fkey_005fid"></a>Function: <em>int</em> <strong>gnutls_openpgp_crt_set_preferred_key_id</strong> <em>(gnutls_openpgp_crt_t <var>key</var>, const gnutls_openpgp_keyid_t <var>keyid</var>)</em></dt>
<dd><p><var>key</var>: the structure that contains the OpenPGP public key.
</p>
<p><var>keyid</var>: the selected keyid
</p>
<p>This allows setting a preferred key id for the given certificate.
This key will be used by functions that involve key handling.
</p>
<p>If the provided  <code>keyid</code> is <code>NULL</code>  then the master key is
set as preferred.
</p>
<p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code>  (0) is returned,
otherwise a negative error code is returned.
</p></dd></dl>

<a name="gnutls_005fopenpgp_005fcrt_005fverify_005fring-1"></a>
<h4 class="subheading">gnutls_openpgp_crt_verify_ring</h4>
<a name="gnutls_005fopenpgp_005fcrt_005fverify_005fring"></a><dl>
<dt><a name="index-gnutls_005fopenpgp_005fcrt_005fverify_005fring-1"></a>Function: <em>int</em> <strong>gnutls_openpgp_crt_verify_ring</strong> <em>(gnutls_openpgp_crt_t <var>key</var>, gnutls_openpgp_keyring_t <var>keyring</var>, unsigned int <var>flags</var>, unsigned int * <var>verify</var>)</em></dt>
<dd><p><var>key</var>: the structure that holds the key.
</p>
<p><var>keyring</var>: holds the keyring to check against
</p>
<p><var>flags</var>: unused (should be 0)
</p>
<p><var>verify</var>: will hold the certificate verification output.
</p>
<p>Verify all signatures in the key, using the given set of keys
(keyring).
</p>
<p>The key verification output will be put in  <code>verify</code> and will be one
or more of the <code>gnutls_certificate_status_t</code>  enumerated elements
bitwise or&rsquo;d.
</p>
<p>Note that this function does not verify using any &quot;web of trust&quot;.
You may use GnuPG for that purpose, or any other external PGP
application.
</p>
<p><strong>Returns:</strong> <code>GNUTLS_E_SUCCESS</code>  on success, or an error code.
</p></dd></dl>

<a name="gnutls_005fopenpgp_005fcrt_005fverify_005fself-1"></a>
<h4 class="subheading">gnutls_openpgp_crt_verify_self</h4>
<a name="gnutls_005fopenpgp_005fcrt_005fverify_005fself"></a><dl>
<dt><a name="index-gnutls_005fopenpgp_005fcrt_005fverify_005fself-1"></a>Function: <em>int</em> <strong>gnutls_openpgp_crt_verify_self</strong> <em>(gnutls_openpgp_crt_t <var>key</var>, unsigned int <var>flags</var>, unsigned int * <var>verify</var>)</em></dt>
<dd><p><var>key</var>: the structure that holds the key.
</p>
<p><var>flags</var>: unused (should be 0)
</p>
<p><var>verify</var>: will hold the key verification output.
</p>
<p>Verifies the self signature in the key.  The key verification
output will be put in  <code>verify</code> and will be one or more of the
gnutls_certificate_status_t enumerated elements bitwise or&rsquo;d.
</p>
<p><strong>Returns:</strong> <code>GNUTLS_E_SUCCESS</code>  on success, or an error code.
</p></dd></dl>

<a name="gnutls_005fopenpgp_005fkeyring_005fcheck_005fid-1"></a>
<h4 class="subheading">gnutls_openpgp_keyring_check_id</h4>
<a name="gnutls_005fopenpgp_005fkeyring_005fcheck_005fid"></a><dl>
<dt><a name="index-gnutls_005fopenpgp_005fkeyring_005fcheck_005fid"></a>Function: <em>int</em> <strong>gnutls_openpgp_keyring_check_id</strong> <em>(gnutls_openpgp_keyring_t <var>ring</var>, const gnutls_openpgp_keyid_t <var>keyid</var>, unsigned int <var>flags</var>)</em></dt>
<dd><p><var>ring</var>: holds the keyring to check against
</p>
<p><var>keyid</var>: will hold the keyid to check for.
</p>
<p><var>flags</var>: unused (should be 0)
</p>
<p>Check if a given key ID exists in the keyring.
</p>
<p><strong>Returns:</strong> <code>GNUTLS_E_SUCCESS</code>  on success (if keyid exists) and a
negative error code on failure.
</p></dd></dl>

<a name="gnutls_005fopenpgp_005fkeyring_005fdeinit-1"></a>
<h4 class="subheading">gnutls_openpgp_keyring_deinit</h4>
<a name="gnutls_005fopenpgp_005fkeyring_005fdeinit"></a><dl>
<dt><a name="index-gnutls_005fopenpgp_005fkeyring_005fdeinit"></a>Function: <em>void</em> <strong>gnutls_openpgp_keyring_deinit</strong> <em>(gnutls_openpgp_keyring_t <var>keyring</var>)</em></dt>
<dd><p><var>keyring</var>: A pointer to the type to be initialized
</p>
<p>This function will deinitialize a keyring structure.
</p></dd></dl>

<a name="gnutls_005fopenpgp_005fkeyring_005fget_005fcrt-1"></a>
<h4 class="subheading">gnutls_openpgp_keyring_get_crt</h4>
<a name="gnutls_005fopenpgp_005fkeyring_005fget_005fcrt"></a><dl>
<dt><a name="index-gnutls_005fopenpgp_005fkeyring_005fget_005fcrt"></a>Function: <em>int</em> <strong>gnutls_openpgp_keyring_get_crt</strong> <em>(gnutls_openpgp_keyring_t <var>ring</var>, unsigned int <var>idx</var>, gnutls_openpgp_crt_t * <var>cert</var>)</em></dt>
<dd><p><var>ring</var>: Holds the keyring.
</p>
<p><var>idx</var>: the index of the certificate to export
</p>
<p><var>cert</var>: An uninitialized <code>gnutls_openpgp_crt_t</code>  type
</p>
<p>This function will extract an OpenPGP certificate from the given
keyring.  If the index given is out of range
<code>GNUTLS_E_REQUESTED_DATA_NOT_AVAILABLE</code>  will be returned. The
returned structure needs to be deinited.
</p>
<p><strong>Returns:</strong> <code>GNUTLS_E_SUCCESS</code>  on success, or an error code.
</p></dd></dl>

<a name="gnutls_005fopenpgp_005fkeyring_005fget_005fcrt_005fcount-1"></a>
<h4 class="subheading">gnutls_openpgp_keyring_get_crt_count</h4>
<a name="gnutls_005fopenpgp_005fkeyring_005fget_005fcrt_005fcount"></a><dl>
<dt><a name="index-gnutls_005fopenpgp_005fkeyring_005fget_005fcrt_005fcount"></a>Function: <em>int</em> <strong>gnutls_openpgp_keyring_get_crt_count</strong> <em>(gnutls_openpgp_keyring_t <var>ring</var>)</em></dt>
<dd><p><var>ring</var>: is an OpenPGP key ring
</p>
<p>This function will return the number of OpenPGP certificates
present in the given keyring.
</p>
<p><strong>Returns:</strong> the number of subkeys, or a negative error code on error.
</p></dd></dl>

<a name="gnutls_005fopenpgp_005fkeyring_005fimport-1"></a>
<h4 class="subheading">gnutls_openpgp_keyring_import</h4>
<a name="gnutls_005fopenpgp_005fkeyring_005fimport"></a><dl>
<dt><a name="index-gnutls_005fopenpgp_005fkeyring_005fimport"></a>Function: <em>int</em> <strong>gnutls_openpgp_keyring_import</strong> <em>(gnutls_openpgp_keyring_t <var>keyring</var>, const gnutls_datum_t * <var>data</var>, gnutls_openpgp_crt_fmt_t <var>format</var>)</em></dt>
<dd><p><var>keyring</var>: The structure to store the parsed key.
</p>
<p><var>data</var>: The RAW or BASE64 encoded keyring.
</p>
<p><var>format</var>: One of <code>gnutls_openpgp_keyring_fmt</code>  elements.
</p>
<p>This function will convert the given RAW or Base64 encoded keyring
to the native <code>gnutls_openpgp_keyring_t</code>  format.  The output will be
stored in &rsquo;keyring&rsquo;.
</p>
<p><strong>Returns:</strong> <code>GNUTLS_E_SUCCESS</code>  on success, or an error code.
</p></dd></dl>

<a name="gnutls_005fopenpgp_005fkeyring_005finit-1"></a>
<h4 class="subheading">gnutls_openpgp_keyring_init</h4>
<a name="gnutls_005fopenpgp_005fkeyring_005finit"></a><dl>
<dt><a name="index-gnutls_005fopenpgp_005fkeyring_005finit"></a>Function: <em>int</em> <strong>gnutls_openpgp_keyring_init</strong> <em>(gnutls_openpgp_keyring_t * <var>keyring</var>)</em></dt>
<dd><p><var>keyring</var>: A pointer to the type to be initialized
</p>
<p>This function will initialize an keyring structure.
</p>
<p><strong>Returns:</strong> <code>GNUTLS_E_SUCCESS</code>  on success, or an error code.
</p></dd></dl>

<a name="gnutls_005fopenpgp_005fprivkey_005fdeinit-1"></a>
<h4 class="subheading">gnutls_openpgp_privkey_deinit</h4>
<a name="gnutls_005fopenpgp_005fprivkey_005fdeinit"></a><dl>
<dt><a name="index-gnutls_005fopenpgp_005fprivkey_005fdeinit"></a>Function: <em>void</em> <strong>gnutls_openpgp_privkey_deinit</strong> <em>(gnutls_openpgp_privkey_t <var>key</var>)</em></dt>
<dd><p><var>key</var>: A pointer to the type to be initialized
</p>
<p>This function will deinitialize a key structure.
</p></dd></dl>

<a name="gnutls_005fopenpgp_005fprivkey_005fexport-1"></a>
<h4 class="subheading">gnutls_openpgp_privkey_export</h4>
<a name="gnutls_005fopenpgp_005fprivkey_005fexport"></a><dl>
<dt><a name="index-gnutls_005fopenpgp_005fprivkey_005fexport"></a>Function: <em>int</em> <strong>gnutls_openpgp_privkey_export</strong> <em>(gnutls_openpgp_privkey_t <var>key</var>, gnutls_openpgp_crt_fmt_t <var>format</var>, const char * <var>password</var>, unsigned int <var>flags</var>, void * <var>output_data</var>, size_t * <var>output_data_size</var>)</em></dt>
<dd><p><var>key</var>: Holds the key.
</p>
<p><var>format</var>: One of gnutls_openpgp_crt_fmt_t elements.
</p>
<p><var>password</var>: the password that will be used to encrypt the key. (unused for now)
</p>
<p><var>flags</var>: (0) for future compatibility
</p>
<p><var>output_data</var>: will contain the key base64 encoded or raw
</p>
<p><var>output_data_size</var>: holds the size of output_data (and will be
replaced by the actual size of parameters)
</p>
<p>This function will convert the given key to RAW or Base64 format.
If the buffer provided is not long enough to hold the output, then
GNUTLS_E_SHORT_MEMORY_BUFFER will be returned.
</p>
<p><strong>Returns:</strong> <code>GNUTLS_E_SUCCESS</code>  on success, or an error code.
</p>
<p><strong>Since:</strong> 2.4.0
</p></dd></dl>

<a name="gnutls_005fopenpgp_005fprivkey_005fexport2-1"></a>
<h4 class="subheading">gnutls_openpgp_privkey_export2</h4>
<a name="gnutls_005fopenpgp_005fprivkey_005fexport2"></a><dl>
<dt><a name="index-gnutls_005fopenpgp_005fprivkey_005fexport2"></a>Function: <em>int</em> <strong>gnutls_openpgp_privkey_export2</strong> <em>(gnutls_openpgp_privkey_t <var>key</var>, gnutls_openpgp_crt_fmt_t <var>format</var>, const char * <var>password</var>, unsigned int <var>flags</var>, gnutls_datum_t * <var>out</var>)</em></dt>
<dd><p><var>key</var>: Holds the key.
</p>
<p><var>format</var>: One of gnutls_openpgp_crt_fmt_t elements.
</p>
<p><var>password</var>: the password that will be used to encrypt the key. (unused for now)
</p>
<p><var>flags</var>: (0) for future compatibility
</p>
<p><var>out</var>: will contain the raw or based64 encoded key
</p>
<p>This function will convert the given key to RAW or Base64 format.
The output buffer is allocated using <code>gnutls_malloc()</code> .
</p>
<p><strong>Returns:</strong> <code>GNUTLS_E_SUCCESS</code>  on success, or an error code.
</p>
<p><strong>Since:</strong> 3.1.3
</p></dd></dl>

<a name="gnutls_005fopenpgp_005fprivkey_005fexport_005fdsa_005fraw-1"></a>
<h4 class="subheading">gnutls_openpgp_privkey_export_dsa_raw</h4>
<a name="gnutls_005fopenpgp_005fprivkey_005fexport_005fdsa_005fraw"></a><dl>
<dt><a name="index-gnutls_005fopenpgp_005fprivkey_005fexport_005fdsa_005fraw"></a>Function: <em>int</em> <strong>gnutls_openpgp_privkey_export_dsa_raw</strong> <em>(gnutls_openpgp_privkey_t <var>pkey</var>, gnutls_datum_t * <var>p</var>, gnutls_datum_t * <var>q</var>, gnutls_datum_t * <var>g</var>, gnutls_datum_t * <var>y</var>, gnutls_datum_t * <var>x</var>)</em></dt>
<dd><p><var>pkey</var>: Holds the certificate
</p>
<p><var>p</var>: will hold the p
</p>
<p><var>q</var>: will hold the q
</p>
<p><var>g</var>: will hold the g
</p>
<p><var>y</var>: will hold the y
</p>
<p><var>x</var>: will hold the x
</p>
<p>This function will export the DSA private key&rsquo;s parameters found in
the given certificate.  The new parameters will be allocated using
<code>gnutls_malloc()</code>  and will be stored in the appropriate datum.
</p>
<p><strong>Returns:</strong> <code>GNUTLS_E_SUCCESS</code>  on success, otherwise a negative error code.
</p>
<p><strong>Since:</strong> 2.4.0
</p></dd></dl>

<a name="gnutls_005fopenpgp_005fprivkey_005fexport_005frsa_005fraw-1"></a>
<h4 class="subheading">gnutls_openpgp_privkey_export_rsa_raw</h4>
<a name="gnutls_005fopenpgp_005fprivkey_005fexport_005frsa_005fraw"></a><dl>
<dt><a name="index-gnutls_005fopenpgp_005fprivkey_005fexport_005frsa_005fraw"></a>Function: <em>int</em> <strong>gnutls_openpgp_privkey_export_rsa_raw</strong> <em>(gnutls_openpgp_privkey_t <var>pkey</var>, gnutls_datum_t * <var>m</var>, gnutls_datum_t * <var>e</var>, gnutls_datum_t * <var>d</var>, gnutls_datum_t * <var>p</var>, gnutls_datum_t * <var>q</var>, gnutls_datum_t * <var>u</var>)</em></dt>
<dd><p><var>pkey</var>: Holds the certificate
</p>
<p><var>m</var>: will hold the modulus
</p>
<p><var>e</var>: will hold the public exponent
</p>
<p><var>d</var>: will hold the private exponent
</p>
<p><var>p</var>: will hold the first prime (p)
</p>
<p><var>q</var>: will hold the second prime (q)
</p>
<p><var>u</var>: will hold the coefficient
</p>
<p>This function will export the RSA private key&rsquo;s parameters found in
the given structure.  The new parameters will be allocated using
<code>gnutls_malloc()</code>  and will be stored in the appropriate datum.
</p>
<p><strong>Returns:</strong> <code>GNUTLS_E_SUCCESS</code>  on success, otherwise a negative error code.
</p>
<p><strong>Since:</strong> 2.4.0
</p></dd></dl>

<a name="gnutls_005fopenpgp_005fprivkey_005fexport_005fsubkey_005fdsa_005fraw-1"></a>
<h4 class="subheading">gnutls_openpgp_privkey_export_subkey_dsa_raw</h4>
<a name="gnutls_005fopenpgp_005fprivkey_005fexport_005fsubkey_005fdsa_005fraw"></a><dl>
<dt><a name="index-gnutls_005fopenpgp_005fprivkey_005fexport_005fsubkey_005fdsa_005fraw"></a>Function: <em>int</em> <strong>gnutls_openpgp_privkey_export_subkey_dsa_raw</strong> <em>(gnutls_openpgp_privkey_t <var>pkey</var>, unsigned int <var>idx</var>, gnutls_datum_t * <var>p</var>, gnutls_datum_t * <var>q</var>, gnutls_datum_t * <var>g</var>, gnutls_datum_t * <var>y</var>, gnutls_datum_t * <var>x</var>)</em></dt>
<dd><p><var>pkey</var>: Holds the certificate
</p>
<p><var>idx</var>: Is the subkey index
</p>
<p><var>p</var>: will hold the p
</p>
<p><var>q</var>: will hold the q
</p>
<p><var>g</var>: will hold the g
</p>
<p><var>y</var>: will hold the y
</p>
<p><var>x</var>: will hold the x
</p>
<p>This function will export the DSA private key&rsquo;s parameters found
in the given certificate.  The new parameters will be allocated
using <code>gnutls_malloc()</code>  and will be stored in the appropriate datum.
</p>
<p><strong>Returns:</strong> <code>GNUTLS_E_SUCCESS</code>  on success, otherwise a negative error code.
</p>
<p><strong>Since:</strong> 2.4.0
</p></dd></dl>

<a name="gnutls_005fopenpgp_005fprivkey_005fexport_005fsubkey_005frsa_005fraw-1"></a>
<h4 class="subheading">gnutls_openpgp_privkey_export_subkey_rsa_raw</h4>
<a name="gnutls_005fopenpgp_005fprivkey_005fexport_005fsubkey_005frsa_005fraw"></a><dl>
<dt><a name="index-gnutls_005fopenpgp_005fprivkey_005fexport_005fsubkey_005frsa_005fraw"></a>Function: <em>int</em> <strong>gnutls_openpgp_privkey_export_subkey_rsa_raw</strong> <em>(gnutls_openpgp_privkey_t <var>pkey</var>, unsigned int <var>idx</var>, gnutls_datum_t * <var>m</var>, gnutls_datum_t * <var>e</var>, gnutls_datum_t * <var>d</var>, gnutls_datum_t * <var>p</var>, gnutls_datum_t * <var>q</var>, gnutls_datum_t * <var>u</var>)</em></dt>
<dd><p><var>pkey</var>: Holds the certificate
</p>
<p><var>idx</var>: Is the subkey index
</p>
<p><var>m</var>: will hold the modulus
</p>
<p><var>e</var>: will hold the public exponent
</p>
<p><var>d</var>: will hold the private exponent
</p>
<p><var>p</var>: will hold the first prime (p)
</p>
<p><var>q</var>: will hold the second prime (q)
</p>
<p><var>u</var>: will hold the coefficient
</p>
<p>This function will export the RSA private key&rsquo;s parameters found in
the given structure.  The new parameters will be allocated using
<code>gnutls_malloc()</code>  and will be stored in the appropriate datum.
</p>
<p><strong>Returns:</strong> <code>GNUTLS_E_SUCCESS</code>  on success, otherwise a negative error code.
</p>
<p><strong>Since:</strong> 2.4.0
</p></dd></dl>

<a name="gnutls_005fopenpgp_005fprivkey_005fget_005ffingerprint-1"></a>
<h4 class="subheading">gnutls_openpgp_privkey_get_fingerprint</h4>
<a name="gnutls_005fopenpgp_005fprivkey_005fget_005ffingerprint"></a><dl>
<dt><a name="index-gnutls_005fopenpgp_005fprivkey_005fget_005ffingerprint"></a>Function: <em>int</em> <strong>gnutls_openpgp_privkey_get_fingerprint</strong> <em>(gnutls_openpgp_privkey_t <var>key</var>, void * <var>fpr</var>, size_t * <var>fprlen</var>)</em></dt>
<dd><p><var>key</var>: the raw data that contains the OpenPGP secret key.
</p>
<p><var>fpr</var>: the buffer to save the fingerprint, must hold at least 20 bytes.
</p>
<p><var>fprlen</var>: the integer to save the length of the fingerprint.
</p>
<p>Get the fingerprint of the OpenPGP key. Depends on the
algorithm, the fingerprint can be 16 or 20 bytes.
</p>
<p><strong>Returns:</strong> On success, 0 is returned, or an error code.
</p>
<p><strong>Since:</strong> 2.4.0
</p></dd></dl>

<a name="gnutls_005fopenpgp_005fprivkey_005fget_005fkey_005fid-1"></a>
<h4 class="subheading">gnutls_openpgp_privkey_get_key_id</h4>
<a name="gnutls_005fopenpgp_005fprivkey_005fget_005fkey_005fid"></a><dl>
<dt><a name="index-gnutls_005fopenpgp_005fprivkey_005fget_005fkey_005fid"></a>Function: <em>int</em> <strong>gnutls_openpgp_privkey_get_key_id</strong> <em>(gnutls_openpgp_privkey_t <var>key</var>, gnutls_openpgp_keyid_t <var>keyid</var>)</em></dt>
<dd><p><var>key</var>: the structure that contains the OpenPGP secret key.
</p>
<p><var>keyid</var>: the buffer to save the keyid.
</p>
<p>Get key-id.
</p>
<p><strong>Returns:</strong> the 64-bit keyID of the OpenPGP key.
</p>
<p><strong>Since:</strong> 2.4.0
</p></dd></dl>

<a name="gnutls_005fopenpgp_005fprivkey_005fget_005fpk_005falgorithm-1"></a>
<h4 class="subheading">gnutls_openpgp_privkey_get_pk_algorithm</h4>
<a name="gnutls_005fopenpgp_005fprivkey_005fget_005fpk_005falgorithm"></a><dl>
<dt><a name="index-gnutls_005fopenpgp_005fprivkey_005fget_005fpk_005falgorithm"></a>Function: <em>gnutls_pk_algorithm_t</em> <strong>gnutls_openpgp_privkey_get_pk_algorithm</strong> <em>(gnutls_openpgp_privkey_t <var>key</var>, unsigned int * <var>bits</var>)</em></dt>
<dd><p><var>key</var>: is an OpenPGP key
</p>
<p><var>bits</var>: if bits is non null it will hold the size of the parameters&rsquo; in bits
</p>
<p>This function will return the public key algorithm of an OpenPGP
certificate.
</p>
<p>If bits is non null, it should have enough size to hold the parameters
size in bits. For RSA the bits returned is the modulus.
For DSA the bits returned are of the public exponent.
</p>
<p><strong>Returns:</strong> a member of the <code>gnutls_pk_algorithm_t</code>  enumeration on
success, or a negative error code on error.
</p>
<p><strong>Since:</strong> 2.4.0
</p></dd></dl>

<a name="gnutls_005fopenpgp_005fprivkey_005fget_005fpreferred_005fkey_005fid-1"></a>
<h4 class="subheading">gnutls_openpgp_privkey_get_preferred_key_id</h4>
<a name="gnutls_005fopenpgp_005fprivkey_005fget_005fpreferred_005fkey_005fid"></a><dl>
<dt><a name="index-gnutls_005fopenpgp_005fprivkey_005fget_005fpreferred_005fkey_005fid"></a>Function: <em>int</em> <strong>gnutls_openpgp_privkey_get_preferred_key_id</strong> <em>(gnutls_openpgp_privkey_t <var>key</var>, gnutls_openpgp_keyid_t <var>keyid</var>)</em></dt>
<dd><p><var>key</var>: the structure that contains the OpenPGP public key.
</p>
<p><var>keyid</var>: the struct to save the keyid.
</p>
<p>Get the preferred key-id for the key.
</p>
<p><strong>Returns:</strong> the 64-bit preferred keyID of the OpenPGP key, or if it
hasn&rsquo;t been set it returns <code>GNUTLS_E_INVALID_REQUEST</code> .
</p></dd></dl>

<a name="gnutls_005fopenpgp_005fprivkey_005fget_005frevoked_005fstatus-1"></a>
<h4 class="subheading">gnutls_openpgp_privkey_get_revoked_status</h4>
<a name="gnutls_005fopenpgp_005fprivkey_005fget_005frevoked_005fstatus"></a><dl>
<dt><a name="index-gnutls_005fopenpgp_005fprivkey_005fget_005frevoked_005fstatus"></a>Function: <em>int</em> <strong>gnutls_openpgp_privkey_get_revoked_status</strong> <em>(gnutls_openpgp_privkey_t <var>key</var>)</em></dt>
<dd><p><var>key</var>: the structure that contains the OpenPGP private key.
</p>
<p>Get revocation status of key.
</p>
<p><strong>Returns:</strong> true (1) if the key has been revoked, or false (0) if it
has not, or a negative error code indicates an error.
</p>
<p><strong>Since:</strong> 2.4.0
</p></dd></dl>

<a name="gnutls_005fopenpgp_005fprivkey_005fget_005fsubkey_005fcount-1"></a>
<h4 class="subheading">gnutls_openpgp_privkey_get_subkey_count</h4>
<a name="gnutls_005fopenpgp_005fprivkey_005fget_005fsubkey_005fcount"></a><dl>
<dt><a name="index-gnutls_005fopenpgp_005fprivkey_005fget_005fsubkey_005fcount"></a>Function: <em>int</em> <strong>gnutls_openpgp_privkey_get_subkey_count</strong> <em>(gnutls_openpgp_privkey_t <var>key</var>)</em></dt>
<dd><p><var>key</var>: is an OpenPGP key
</p>
<p>This function will return the number of subkeys present in the
given OpenPGP certificate.
</p>
<p><strong>Returns:</strong> the number of subkeys, or a negative error code on error.
</p>
<p><strong>Since:</strong> 2.4.0
</p></dd></dl>

<a name="gnutls_005fopenpgp_005fprivkey_005fget_005fsubkey_005fcreation_005ftime-1"></a>
<h4 class="subheading">gnutls_openpgp_privkey_get_subkey_creation_time</h4>
<a name="gnutls_005fopenpgp_005fprivkey_005fget_005fsubkey_005fcreation_005ftime"></a><dl>
<dt><a name="index-gnutls_005fopenpgp_005fprivkey_005fget_005fsubkey_005fcreation_005ftime"></a>Function: <em>time_t</em> <strong>gnutls_openpgp_privkey_get_subkey_creation_time</strong> <em>(gnutls_openpgp_privkey_t       <var>key</var>, unsigned int <var>idx</var>)</em></dt>
<dd><p><var>key</var>: the structure that contains the OpenPGP private key.
</p>
<p><var>idx</var>: the subkey index
</p>
<p>Get subkey creation time.
</p>
<p><strong>Returns:</strong> the timestamp when the OpenPGP key was created.
</p>
<p><strong>Since:</strong> 2.4.0
</p></dd></dl>

<a name="gnutls_005fopenpgp_005fprivkey_005fget_005fsubkey_005fexpiration_005ftime-1"></a>
<h4 class="subheading">gnutls_openpgp_privkey_get_subkey_expiration_time</h4>
<a name="gnutls_005fopenpgp_005fprivkey_005fget_005fsubkey_005fexpiration_005ftime"></a><dl>
<dt><a name="index-gnutls_005fopenpgp_005fprivkey_005fget_005fsubkey_005fexpiration_005ftime"></a>Function: <em>time_t</em> <strong>gnutls_openpgp_privkey_get_subkey_expiration_time</strong> <em>(gnutls_openpgp_privkey_t         <var>key</var>, unsigned int <var>idx</var>)</em></dt>
<dd><p><var>key</var>: the structure that contains the OpenPGP private key.
</p>
<p><var>idx</var>: the subkey index
</p>
<p>Get subkey expiration time.  A value of &rsquo;0&rsquo; means that the key
doesn&rsquo;t expire at all.
</p>
<p><strong>Returns:</strong> the time when the OpenPGP key expires.
</p>
<p><strong>Since:</strong> 2.4.0
</p></dd></dl>

<a name="gnutls_005fopenpgp_005fprivkey_005fget_005fsubkey_005ffingerprint-1"></a>
<h4 class="subheading">gnutls_openpgp_privkey_get_subkey_fingerprint</h4>
<a name="gnutls_005fopenpgp_005fprivkey_005fget_005fsubkey_005ffingerprint"></a><dl>
<dt><a name="index-gnutls_005fopenpgp_005fprivkey_005fget_005fsubkey_005ffingerprint"></a>Function: <em>int</em> <strong>gnutls_openpgp_privkey_get_subkey_fingerprint</strong> <em>(gnutls_openpgp_privkey_t <var>key</var>, unsigned int <var>idx</var>, void * <var>fpr</var>, size_t * <var>fprlen</var>)</em></dt>
<dd><p><var>key</var>: the raw data that contains the OpenPGP secret key.
</p>
<p><var>idx</var>: the subkey index
</p>
<p><var>fpr</var>: the buffer to save the fingerprint, must hold at least 20 bytes.
</p>
<p><var>fprlen</var>: the integer to save the length of the fingerprint.
</p>
<p>Get the fingerprint of an OpenPGP subkey.  Depends on the
algorithm, the fingerprint can be 16 or 20 bytes.
</p>
<p><strong>Returns:</strong> On success, 0 is returned, or an error code.
</p>
<p><strong>Since:</strong> 2.4.0
</p></dd></dl>

<a name="gnutls_005fopenpgp_005fprivkey_005fget_005fsubkey_005fid-1"></a>
<h4 class="subheading">gnutls_openpgp_privkey_get_subkey_id</h4>
<a name="gnutls_005fopenpgp_005fprivkey_005fget_005fsubkey_005fid"></a><dl>
<dt><a name="index-gnutls_005fopenpgp_005fprivkey_005fget_005fsubkey_005fid"></a>Function: <em>int</em> <strong>gnutls_openpgp_privkey_get_subkey_id</strong> <em>(gnutls_openpgp_privkey_t <var>key</var>, unsigned int <var>idx</var>, gnutls_openpgp_keyid_t <var>keyid</var>)</em></dt>
<dd><p><var>key</var>: the structure that contains the OpenPGP secret key.
</p>
<p><var>idx</var>: the subkey index
</p>
<p><var>keyid</var>: the buffer to save the keyid.
</p>
<p>Get the key-id for the subkey.
</p>
<p><strong>Returns:</strong> the 64-bit keyID of the OpenPGP key.
</p>
<p><strong>Since:</strong> 2.4.0
</p></dd></dl>

<a name="gnutls_005fopenpgp_005fprivkey_005fget_005fsubkey_005fidx-1"></a>
<h4 class="subheading">gnutls_openpgp_privkey_get_subkey_idx</h4>
<a name="gnutls_005fopenpgp_005fprivkey_005fget_005fsubkey_005fidx"></a><dl>
<dt><a name="index-gnutls_005fopenpgp_005fprivkey_005fget_005fsubkey_005fidx"></a>Function: <em>int</em> <strong>gnutls_openpgp_privkey_get_subkey_idx</strong> <em>(gnutls_openpgp_privkey_t <var>key</var>, const gnutls_openpgp_keyid_t <var>keyid</var>)</em></dt>
<dd><p><var>key</var>: the structure that contains the OpenPGP private key.
</p>
<p><var>keyid</var>: the keyid.
</p>
<p>Get index of subkey.
</p>
<p><strong>Returns:</strong> the index of the subkey or a negative error value.
</p>
<p><strong>Since:</strong> 2.4.0
</p></dd></dl>

<a name="gnutls_005fopenpgp_005fprivkey_005fget_005fsubkey_005fpk_005falgorithm-1"></a>
<h4 class="subheading">gnutls_openpgp_privkey_get_subkey_pk_algorithm</h4>
<a name="gnutls_005fopenpgp_005fprivkey_005fget_005fsubkey_005fpk_005falgorithm"></a><dl>
<dt><a name="index-gnutls_005fopenpgp_005fprivkey_005fget_005fsubkey_005fpk_005falgorithm"></a>Function: <em>gnutls_pk_algorithm_t</em> <strong>gnutls_openpgp_privkey_get_subkey_pk_algorithm</strong> <em>(gnutls_openpgp_privkey_t             <var>key</var>, unsigned int <var>idx</var>, unsigned int * <var>bits</var>)</em></dt>
<dd><p><var>key</var>: is an OpenPGP key
</p>
<p><var>idx</var>: is the subkey index
</p>
<p><var>bits</var>: if bits is non null it will hold the size of the parameters&rsquo; in bits
</p>
<p>This function will return the public key algorithm of a subkey of an OpenPGP
certificate.
</p>
<p>If bits is non null, it should have enough size to hold the parameters
size in bits. For RSA the bits returned is the modulus.
For DSA the bits returned are of the public exponent.
</p>
<p><strong>Returns:</strong> a member of the <code>gnutls_pk_algorithm_t</code>  enumeration on
success, or a negative error code on error.
</p>
<p><strong>Since:</strong> 2.4.0
</p></dd></dl>

<a name="gnutls_005fopenpgp_005fprivkey_005fget_005fsubkey_005frevoked_005fstatus-1"></a>
<h4 class="subheading">gnutls_openpgp_privkey_get_subkey_revoked_status</h4>
<a name="gnutls_005fopenpgp_005fprivkey_005fget_005fsubkey_005frevoked_005fstatus"></a><dl>
<dt><a name="index-gnutls_005fopenpgp_005fprivkey_005fget_005fsubkey_005frevoked_005fstatus"></a>Function: <em>int</em> <strong>gnutls_openpgp_privkey_get_subkey_revoked_status</strong> <em>(gnutls_openpgp_privkey_t        <var>key</var>, unsigned int <var>idx</var>)</em></dt>
<dd><p><var>key</var>: the structure that contains the OpenPGP private key.
</p>
<p><var>idx</var>: is the subkey index
</p>
<p>Get revocation status of key.
</p>
<p><strong>Returns:</strong> true (1) if the key has been revoked, or false (0) if it
has not, or a negative error code indicates an error.
</p>
<p><strong>Since:</strong> 2.4.0
</p></dd></dl>

<a name="gnutls_005fopenpgp_005fprivkey_005fimport-1"></a>
<h4 class="subheading">gnutls_openpgp_privkey_import</h4>
<a name="gnutls_005fopenpgp_005fprivkey_005fimport"></a><dl>
<dt><a name="index-gnutls_005fopenpgp_005fprivkey_005fimport"></a>Function: <em>int</em> <strong>gnutls_openpgp_privkey_import</strong> <em>(gnutls_openpgp_privkey_t <var>key</var>, const gnutls_datum_t * <var>data</var>, gnutls_openpgp_crt_fmt_t <var>format</var>, const char * <var>password</var>, unsigned int <var>flags</var>)</em></dt>
<dd><p><var>key</var>: The structure to store the parsed key.
</p>
<p><var>data</var>: The RAW or BASE64 encoded key.
</p>
<p><var>format</var>: One of <code>gnutls_openpgp_crt_fmt_t</code>  elements.
</p>
<p><var>password</var>: not used for now
</p>
<p><var>flags</var>: should be (0)
</p>
<p>This function will convert the given RAW or Base64 encoded key to
the native gnutls_openpgp_privkey_t format.  The output will be
stored in &rsquo;key&rsquo;.
</p>
<p><strong>Returns:</strong> <code>GNUTLS_E_SUCCESS</code>  on success, or an error code.
</p></dd></dl>

<a name="gnutls_005fopenpgp_005fprivkey_005finit-1"></a>
<h4 class="subheading">gnutls_openpgp_privkey_init</h4>
<a name="gnutls_005fopenpgp_005fprivkey_005finit"></a><dl>
<dt><a name="index-gnutls_005fopenpgp_005fprivkey_005finit"></a>Function: <em>int</em> <strong>gnutls_openpgp_privkey_init</strong> <em>(gnutls_openpgp_privkey_t * <var>key</var>)</em></dt>
<dd><p><var>key</var>: A pointer to the type to be initialized
</p>
<p>This function will initialize an OpenPGP key structure.
</p>
<p><strong>Returns:</strong> <code>GNUTLS_E_SUCCESS</code>  on success, or an error code.
</p></dd></dl>

<a name="gnutls_005fopenpgp_005fprivkey_005fsec_005fparam-1"></a>
<h4 class="subheading">gnutls_openpgp_privkey_sec_param</h4>
<a name="gnutls_005fopenpgp_005fprivkey_005fsec_005fparam"></a><dl>
<dt><a name="index-gnutls_005fopenpgp_005fprivkey_005fsec_005fparam"></a>Function: <em>gnutls_sec_param_t</em> <strong>gnutls_openpgp_privkey_sec_param</strong> <em>(gnutls_openpgp_privkey_t <var>key</var>)</em></dt>
<dd><p><var>key</var>: a key structure
</p>
<p>This function will return the security parameter appropriate with
this private key.
</p>
<p><strong>Returns:</strong> On success, a valid security parameter is returned otherwise
<code>GNUTLS_SEC_PARAM_UNKNOWN</code>  is returned.
</p>
<p><strong>Since:</strong> 2.12.0
</p></dd></dl>

<a name="gnutls_005fopenpgp_005fprivkey_005fset_005fpreferred_005fkey_005fid-1"></a>
<h4 class="subheading">gnutls_openpgp_privkey_set_preferred_key_id</h4>
<a name="gnutls_005fopenpgp_005fprivkey_005fset_005fpreferred_005fkey_005fid"></a><dl>
<dt><a name="index-gnutls_005fopenpgp_005fprivkey_005fset_005fpreferred_005fkey_005fid"></a>Function: <em>int</em> <strong>gnutls_openpgp_privkey_set_preferred_key_id</strong> <em>(gnutls_openpgp_privkey_t <var>key</var>, const gnutls_openpgp_keyid_t          <var>keyid</var>)</em></dt>
<dd><p><var>key</var>: the structure that contains the OpenPGP public key.
</p>
<p><var>keyid</var>: the selected keyid
</p>
<p>This allows setting a preferred key id for the given certificate.
This key will be used by functions that involve key handling.
</p>
<p>If the provided  <code>keyid</code> is <code>NULL</code>  then the master key is
set as preferred.
</p>
<p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code>  (0) is returned,
otherwise a negative error code is returned.
</p></dd></dl>

<a name="gnutls_005fopenpgp_005fset_005frecv_005fkey_005ffunction-1"></a>
<h4 class="subheading">gnutls_openpgp_set_recv_key_function</h4>
<a name="gnutls_005fopenpgp_005fset_005frecv_005fkey_005ffunction"></a><dl>
<dt><a name="index-gnutls_005fopenpgp_005fset_005frecv_005fkey_005ffunction"></a>Function: <em>void</em> <strong>gnutls_openpgp_set_recv_key_function</strong> <em>(gnutls_session_t <var>session</var>, gnutls_openpgp_recv_key_func <var>func</var>)</em></dt>
<dd><p><var>session</var>: a TLS session
</p>
<p><var>func</var>: the callback
</p>
<p>This function will set a key retrieval function for OpenPGP keys. This
callback is only useful in server side, and will be used if the peer
sent a key fingerprint instead of a full key.
</p>
<p>The retrieved key must be allocated using <code>gnutls_malloc()</code> .
</p></dd></dl>


<hr>
<div class="header">
<p>
Next: <a href="PKCS-12-API.html#PKCS-12-API" accesskey="n" rel="next">PKCS 12 API</a>, Previous: <a href="OCSP-API.html#OCSP-API" accesskey="p" rel="prev">OCSP API</a>, Up: <a href="API-reference.html#API-reference" accesskey="u" rel="up">API reference</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Function-and-Data-Index.html#Function-and-Data-Index" title="Index" rel="index">Index</a>]</p>
</div>



</body>
</html>
